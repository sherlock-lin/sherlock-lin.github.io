<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Ê¶ÇËø∞ È¶ñÂÖàÔºåÊàë‰ª¨ÁöÑÊÄßËÉΩÂØπÊØîÊµãËØïÊòØ‰ª•Ê°à‰æã‰∏∫Á≤íÂ∫¶ÁöÑÔºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑCase By Case„ÄÇÁÑ∂ÂêéÔºåÂú®ÊØè‰∏Ä‰∏™Ê°à‰æã‰∏≠ÔºåÊàë‰ª¨ÈÉΩÊúâÂØπÊØîÂü∫ÂáÜÔºàBaselineÔºâ„ÄÇÂØπÊØîÂü∫ÂáÜÁöÑÂê´‰πâÊòØÔºåÂú®‰∏çÈááÂèñ‰ªª‰ΩïË∞É‰ºòÊñπÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•Êää‰ª£Á†Å‰∫§‰ªòÊâßË°åÂæóÂà∞ÁöÑËøêË°åÊó∂Èó¥„ÄÇ‰πãÂêéÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™Ê°à‰æãÔºåÊàë‰ª¨‰ºöÈááÂèñ‰∏ÄÁßçÊàñÂ§öÁßçË∞É‰ºòÊñπÊ≥ïÂÅöÊÄßËÉΩ‰ºòÂåñÔºåÊØè‰∏ÄÁßçË∞É‰ºòÊñπÊ≥ïÈÉΩÊúâ‰∏é‰πãÂØπÂ∫îÁöÑËøêË°åÊó∂Èó¥„ÄÇÊúÄÁªàÔºåÊàë‰ª¨Â∞Ü‰∏çÂêåË∞É‰ºòÊñπÊ≥ïÁöÑËøêË°åÊó∂Èó¥‰∏éÂØπÊØîÂü∫ÂáÜÂÅöÊ®™ÂêëÊØîËæÉÔºåÊù•ËßÇÂØüË∞É‰ºòÂâçÂêéÁöÑÊÄßËÉΩÂ∑ÆÂºÇÔºåÂπ∂ÂàÜÊûêÊÄßËÉΩÊèêÂçá/‰∏ãÈôçÁöÑËÉåÂêéÂéüÂõ†„ÄÇ\n">
<title>ÊâãÊääÊâãÂ∏¶‰Ω†ÊèêÂçáÂ∫îÁî®ÁöÑÊâßË°åÊÄßËÉΩ</title>

<link rel='canonical' href='https://sherlock-lin.github.io/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="ÊâãÊääÊâãÂ∏¶‰Ω†ÊèêÂçáÂ∫îÁî®ÁöÑÊâßË°åÊÄßËÉΩ">
<meta property='og:description' content="Ê¶ÇËø∞ È¶ñÂÖàÔºåÊàë‰ª¨ÁöÑÊÄßËÉΩÂØπÊØîÊµãËØïÊòØ‰ª•Ê°à‰æã‰∏∫Á≤íÂ∫¶ÁöÑÔºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑCase By Case„ÄÇÁÑ∂ÂêéÔºåÂú®ÊØè‰∏Ä‰∏™Ê°à‰æã‰∏≠ÔºåÊàë‰ª¨ÈÉΩÊúâÂØπÊØîÂü∫ÂáÜÔºàBaselineÔºâ„ÄÇÂØπÊØîÂü∫ÂáÜÁöÑÂê´‰πâÊòØÔºåÂú®‰∏çÈááÂèñ‰ªª‰ΩïË∞É‰ºòÊñπÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•Êää‰ª£Á†Å‰∫§‰ªòÊâßË°åÂæóÂà∞ÁöÑËøêË°åÊó∂Èó¥„ÄÇ‰πãÂêéÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™Ê°à‰æãÔºåÊàë‰ª¨‰ºöÈááÂèñ‰∏ÄÁßçÊàñÂ§öÁßçË∞É‰ºòÊñπÊ≥ïÂÅöÊÄßËÉΩ‰ºòÂåñÔºåÊØè‰∏ÄÁßçË∞É‰ºòÊñπÊ≥ïÈÉΩÊúâ‰∏é‰πãÂØπÂ∫îÁöÑËøêË°åÊó∂Èó¥„ÄÇÊúÄÁªàÔºåÊàë‰ª¨Â∞Ü‰∏çÂêåË∞É‰ºòÊñπÊ≥ïÁöÑËøêË°åÊó∂Èó¥‰∏éÂØπÊØîÂü∫ÂáÜÂÅöÊ®™ÂêëÊØîËæÉÔºåÊù•ËßÇÂØüË∞É‰ºòÂâçÂêéÁöÑÊÄßËÉΩÂ∑ÆÂºÇÔºåÂπ∂ÂàÜÊûêÊÄßËÉΩÊèêÂçá/‰∏ãÈôçÁöÑËÉåÂêéÂéüÂõ†„ÄÇ\n">
<meta property='og:url' content='https://sherlock-lin.github.io/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/'>
<meta property='og:site_name' content='Â§èÊ¥õÂÖã-Êûó'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-04-13T10:03:32&#43;08:00'/><meta property='article:modified_time' content='2025-04-13T10:03:32&#43;08:00'/><meta property='og:image' content='https://sherlock-lin.github.io/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770.png' />
<meta name="twitter:title" content="ÊâãÊääÊâãÂ∏¶‰Ω†ÊèêÂçáÂ∫îÁî®ÁöÑÊâßË°åÊÄßËÉΩ">
<meta name="twitter:description" content="Ê¶ÇËø∞ È¶ñÂÖàÔºåÊàë‰ª¨ÁöÑÊÄßËÉΩÂØπÊØîÊµãËØïÊòØ‰ª•Ê°à‰æã‰∏∫Á≤íÂ∫¶ÁöÑÔºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑCase By Case„ÄÇÁÑ∂ÂêéÔºåÂú®ÊØè‰∏Ä‰∏™Ê°à‰æã‰∏≠ÔºåÊàë‰ª¨ÈÉΩÊúâÂØπÊØîÂü∫ÂáÜÔºàBaselineÔºâ„ÄÇÂØπÊØîÂü∫ÂáÜÁöÑÂê´‰πâÊòØÔºåÂú®‰∏çÈááÂèñ‰ªª‰ΩïË∞É‰ºòÊñπÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•Êää‰ª£Á†Å‰∫§‰ªòÊâßË°åÂæóÂà∞ÁöÑËøêË°åÊó∂Èó¥„ÄÇ‰πãÂêéÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™Ê°à‰æãÔºåÊàë‰ª¨‰ºöÈááÂèñ‰∏ÄÁßçÊàñÂ§öÁßçË∞É‰ºòÊñπÊ≥ïÂÅöÊÄßËÉΩ‰ºòÂåñÔºåÊØè‰∏ÄÁßçË∞É‰ºòÊñπÊ≥ïÈÉΩÊúâ‰∏é‰πãÂØπÂ∫îÁöÑËøêË°åÊó∂Èó¥„ÄÇÊúÄÁªàÔºåÊàë‰ª¨Â∞Ü‰∏çÂêåË∞É‰ºòÊñπÊ≥ïÁöÑËøêË°åÊó∂Èó¥‰∏éÂØπÊØîÂü∫ÂáÜÂÅöÊ®™ÂêëÊØîËæÉÔºåÊù•ËßÇÂØüË∞É‰ºòÂâçÂêéÁöÑÊÄßËÉΩÂ∑ÆÂºÇÔºåÂπ∂ÂàÜÊûêÊÄßËÉΩÊèêÂçá/‰∏ãÈôçÁöÑËÉåÂêéÂéüÂõ†„ÄÇ\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://sherlock-lin.github.io/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/cs_hu10005534405353342465.jpg" width="300"
                            height="294" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ü•≥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Â§èÊ¥õÂÖã-Êûó</a></h1>
            <h2 class="site-description">Ê¨¢ËøéÊù•Âà∞‰∏Ä‰∏™ËØª‰π¶ÁãÇÈ≠î„ÄÅÂÅèÊâßÁãÇÁöÑÂçöÂÆ¢~</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>ÂèãÊÉÖÈìæÊé•</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>ÊöóËâ≤Ê®°Âºè</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#Ê¶ÇËø∞">Ê¶ÇËø∞</a></li>
    <li><a href="#ËøêË°åÁéØÂ¢É">ËøêË°åÁéØÂ¢É</a></li>
    <li><a href="#Ê°à‰æã1ÁöÑÊÄßËÉΩË∞É‰ºò‰∫∫Êï∞ÁªüËÆ°">Ê°à‰æã1ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∫∫Êï∞ÁªüËÆ°</a></li>
    <li><a href="#Ê°à‰æã2ÁöÑÊÄßËÉΩË∞É‰ºòÊëáÂè∑Ê¨°Êï∞ÂàÜÂ∏É">Ê°à‰æã2ÁöÑÊÄßËÉΩË∞É‰ºòÔºöÊëáÂè∑Ê¨°Êï∞ÂàÜÂ∏É</a>
      <ol>
        <li><a href="#Âú∫ÊôØ1ÂèÇ‰∏éÊëáÂè∑ÁöÑÁî≥ËØ∑ËÄÖ">Âú∫ÊôØ1ÔºöÂèÇ‰∏éÊëáÂè∑ÁöÑÁî≥ËØ∑ËÄÖ</a>
          <ol>
            <li><a href="#ÊÄùË∑Ø1shuffleÂ∏∏ËßÑ‰ºòÂåñ">ÊÄùË∑Ø1ÔºöShuffleÂ∏∏ËßÑ‰ºòÂåñ</a></li>
            <li><a href="#ÊÄùË∑Ø2Êï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂">ÊÄùË∑Ø2ÔºöÊï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂</a></li>
            <li><a href="#ÊÄùË∑Ø3Âä†cache">ÊÄùË∑Ø3ÔºöÂä†Cache</a></li>
          </ol>
        </li>
        <li><a href="#Âú∫ÊôØ2Âπ∏ËøêÁöÑ‰∏≠Á≠æËÄÖ">Âú∫ÊôØ2ÔºöÂπ∏ËøêÁöÑ‰∏≠Á≠æËÄÖ</a></li>
      </ol>
    </li>
    <li><a href="#Ê°à‰æã3ÁöÑÊÄßËÉΩË∞É‰ºò‰∏≠Á≠æÁéáÁöÑÂèòÂåñË∂ãÂäø">Ê°à‰æã3ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∏≠Á≠æÁéáÁöÑÂèòÂåñË∂ãÂäø</a></li>
    <li><a href="#Ê°à‰æã4ÁöÑÊÄßËÉΩË∞É‰ºò‰∏≠Á≠æÁéáÂ±ÄÈÉ®Ê¥ûÂØü">Ê°à‰æã4ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∏≠Á≠æÁéáÂ±ÄÈÉ®Ê¥ûÂØü</a></li>
    <li><a href="#Ê°à‰æã5ÁöÑÊÄßËÉΩË∞É‰ºòÂÄçÁéáÂàÜÊûê">Ê°à‰æã5ÁöÑÊÄßËÉΩË∞É‰ºòÔºöÂÄçÁéáÂàÜÊûê</a></li>
    <li><a href="#ÊÄªÁªì">ÊÄªÁªì</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/">
                <img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770_hu8111209649381182372.png"
                        srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770_hu8111209649381182372.png 800w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770_hu12029128755062440849.png 1600w"
                        width="800" 
                        height="140" 
                        loading="lazy"
                        alt="Featured image of post ÊâãÊääÊâãÂ∏¶‰Ω†ÊèêÂçáÂ∫îÁî®ÁöÑÊâßË°åÊÄßËÉΩ" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/spark/" style="background-color: #2a9d8f; color: #fff;">
                Spark
            </a>
        
            <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="background-color: #2a9d8f; color: #fff;">
                Â§ßÊï∞ÊçÆ
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/">ÊâãÊääÊâãÂ∏¶‰Ω†ÊèêÂçáÂ∫îÁî®ÁöÑÊâßË°åÊÄßËÉΩ</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-04-13</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 18 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="Ê¶ÇËø∞">Ê¶ÇËø∞
</h2><p>È¶ñÂÖàÔºåÊàë‰ª¨ÁöÑÊÄßËÉΩÂØπÊØîÊµãËØïÊòØ‰ª•Ê°à‰æã‰∏∫Á≤íÂ∫¶ÁöÑÔºå‰πüÂ∞±ÊòØÂ∏∏ËØ¥ÁöÑCase By Case„ÄÇÁÑ∂ÂêéÔºåÂú®ÊØè‰∏Ä‰∏™Ê°à‰æã‰∏≠ÔºåÊàë‰ª¨ÈÉΩÊúâÂØπÊØîÂü∫ÂáÜÔºàBaselineÔºâ„ÄÇÂØπÊØîÂü∫ÂáÜÁöÑÂê´‰πâÊòØÔºåÂú®‰∏çÈááÂèñ‰ªª‰ΩïË∞É‰ºòÊñπÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•Êää‰ª£Á†Å‰∫§‰ªòÊâßË°åÂæóÂà∞ÁöÑËøêË°åÊó∂Èó¥„ÄÇ‰πãÂêéÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™Ê°à‰æãÔºåÊàë‰ª¨‰ºöÈááÂèñ‰∏ÄÁßçÊàñÂ§öÁßçË∞É‰ºòÊñπÊ≥ïÂÅöÊÄßËÉΩ‰ºòÂåñÔºåÊØè‰∏ÄÁßçË∞É‰ºòÊñπÊ≥ïÈÉΩÊúâ‰∏é‰πãÂØπÂ∫îÁöÑËøêË°åÊó∂Èó¥„ÄÇÊúÄÁªàÔºåÊàë‰ª¨Â∞Ü‰∏çÂêåË∞É‰ºòÊñπÊ≥ïÁöÑËøêË°åÊó∂Èó¥‰∏éÂØπÊØîÂü∫ÂáÜÂÅöÊ®™ÂêëÊØîËæÉÔºåÊù•ËßÇÂØüË∞É‰ºòÂâçÂêéÁöÑÊÄßËÉΩÂ∑ÆÂºÇÔºåÂπ∂ÂàÜÊûêÊÄßËÉΩÊèêÂçá/‰∏ãÈôçÁöÑËÉåÂêéÂéüÂõ†„ÄÇ</p>
<h2 id="ËøêË°åÁéØÂ¢É">ËøêË°åÁéØÂ¢É
</h2><p>Êó¢ÁÑ∂Ë∞É‰ºòÊïàÊûú‰∏ªË¶ÅÁî±ÊâßË°åÊó∂Èó¥Êù•‰ΩìÁé∞ÔºåÈÇ£Âú®ÂºÄÂßãË∞É‰ºò‰πãÂâçÔºåÊàë‰ª¨ÊúâÂøÖË¶ÅÂÖàÊù•‰∫§‰ª£‰∏Ä‰∏ãÊÄßËÉΩÊµãËØïÈááÁî®ÁöÑÁ°¨‰ª∂ËµÑÊ∫êÂíåÈÖçÁΩÆÈ°πËÆæÁΩÆ„ÄÇÁ°¨‰ª∂ËµÑÊ∫êÂ¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093812370-4508294.png"
	width="1576"
	height="654"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093812370-4508294_hu5883318359604148002.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093812370-4508294_hu11163816695912996630.png 1024w"
	loading="lazy"
	
		alt="image-20250413093812370"
	
	
		class="gallery-image" 
		data-flex-grow="240"
		data-flex-basis="578px"
	
></p>
<p>‰∏∫‰∫ÜÈÅøÂÖçÂõ†‰∏∫ÂÆûÈ™åÊú¨Ë∫´ËÄåÁ≠âÂæÖÂ§™ÈïøÁöÑÊó∂Èó¥ÔºåÊàë‰ΩøÁî®‰∫ÜÊØîËæÉÂº∫ÊÇçÁöÑÊú∫Âô®ËµÑÊ∫ê„ÄÇÂÆûÈôÖ‰∏äÔºå‰∏∫‰∫ÜË∑ëÈÄöÂ∫îÁî®ÔºåÂÆåÊàêÊÄßËÉΩÂØπÊØîÊµãËØïÔºå‰Ω†‰ΩøÁî®Á¨îËÆ∞Êú¨‰πüÂèØ‰ª•„ÄÇËÄå‰∏î‰∏∫‰∫ÜÁªôÂêéÁª≠Ë∞É‰ºòÁïôÂá∫Ë∂≥Â§üÁ©∫Èó¥ÔºåÈô§‰∫ÜÂøÖÈúÄÁöÑËøêË°åËµÑÊ∫êËÆæÁΩÆ‰ª•Â§ñÔºåÂÖ∂‰ªñÈÖçÁΩÆÈ°πÂÖ®ÈÉ®‰øùÁïô‰∫ÜÈªòËÆ§ÂÄºÔºåÂÖ∑‰ΩìÁöÑËµÑÊ∫êÈÖçÁΩÆÂ¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093832407-4508315.png"
	width="1592"
	height="346"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093832407-4508315_hu16134904733307872087.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413093832407-4508315_hu7463283643252428806.png 1024w"
	loading="lazy"
	
		alt="image-20250413093832407"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1104px"
	
></p>
<p>Âè¶Â§ñÔºåÁî±‰∫éË∞É‰ºòÊñπÊ≥ï‰∏≠Ê∂âÂèäAQEÂíåDPPËøô‰∫õSpark 3.0Êñ∞ÁâπÊÄßÔºåÂõ†Ê≠§ÔºåÊàëÂª∫ËÆÆ‰Ω†‰ΩøÁî®3.0Âèä‰ª•‰∏äÁöÑSparkÁâàÊú¨Êù•ÈÉ®ÁΩ≤ËøêË°åÁéØÂ¢ÉÔºåÊàëËøôËæπÈááÁî®ÁöÑÁâàÊú¨Âè∑ÊòØSpark 3.1.1„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞±Case By CaseÂú∞ÂéªÂõûÈ°æ‰ª£Á†ÅÂÆûÁé∞ÔºåÂàÜÂà´ÂàÜÊûê5‰∏™Ê°à‰æãÁöÑ‰ºòÂåñÁ©∫Èó¥„ÄÅÂèØËÉΩÁöÑË∞É‰ºòÊñπÊ≥ï„ÄÅÊñπÊ≥ïÁöÑÊïàÊûúÔºå‰ª•ÂèäÂÆÉ‰ª¨‰∏éÂØπÊØîÂü∫ÂáÜÁöÑÊÄßËÉΩÂ∑ÆÂºÇ„ÄÇ</p>
<h2 id="Ê°à‰æã1ÁöÑÊÄßËÉΩË∞É‰ºò‰∫∫Êï∞ÁªüËÆ°">Ê°à‰æã1ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∫∫Êï∞ÁªüËÆ°
</h2><p>È¶ñÂÖàÔºåÊàë‰ª¨ÂÖàÊù•ÂõûÈ°æÊ°à‰æã1„ÄÇÊ°à‰æã1ÁöÑÊÑèÂõæÊòØÁªüËÆ°ÊëáÂè∑ÊÄª‰∫∫Ê¨°„ÄÅ‰∏≠Á≠æËÄÖ‰∫∫Êï∞Ôºå‰ª•ÂèäÂéªÊéâÂÄçÁéáÂΩ±Âìç‰πãÂêéÁöÑÊëáÂè∑ÊÄª‰∫∫Ê¨°Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÊâÄÁ§∫„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">val</span> <span class="n">rootPath</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="k">_</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">// Áî≥ËØ∑ËÄÖÊï∞ÊçÆÔºàÂõ†‰∏∫ÂÄçÁéáÁöÑÂéüÂõ†ÔºåÊØè‰∏ÄÊúüÔºåÂêå‰∏Ä‰∏™‰∫∫ÔºåÂèØËÉΩÊúâÂ§ö‰∏™Âè∑Á†ÅÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="n">hdfs_path_apply</span> <span class="k">=</span> <span class="s">s&#34;</span><span class="si">${</span><span class="n">rootPath</span><span class="si">}</span><span class="s">/apply&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="n">applyNumbersDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="o">(</span><span class="n">hdfs_path_apply</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">applyNumbersDF</span><span class="o">.</span><span class="n">count</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ‰∏≠Á≠æËÄÖÊï∞ÊçÆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="n">hdfs_path_lucky</span> <span class="k">=</span> <span class="s">s&#34;</span><span class="si">${</span><span class="n">rootPath</span><span class="si">}</span><span class="s">/lucky&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="n">luckyDogsDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="o">(</span><span class="n">hdfs_path_lucky</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">luckyDogsDF</span><span class="o">.</span><span class="n">count</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">// Áî≥ËØ∑ËÄÖÊï∞ÊçÆÔºàÂéªÊéâÂÄçÁéáÁöÑÂΩ±ÂìçÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="n">applyDistinctDF</span> <span class="k">=</span> <span class="n">applyNumbersDF</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">&#34;batchNum&#34;</span><span class="o">,</span> <span class="s">&#34;carNum&#34;</span><span class="o">).</span><span class="n">distinct</span>
</span></span><span class="line"><span class="cl"><span class="n">applyDistinctDF</span><span class="o">.</span><span class="n">count</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂÆûÁé∞‰∏≠ÔºåÊàë‰ª¨‰∏çÈöæÂèëÁé∞ÔºåÁü≠Áü≠ÁöÑÂá†Ë°å‰ª£Á†ÅÂÖ±Êúâ3‰∏™ActionsÔºå‰πüÂ∞±ÊòØ3‰∏™‰∏çÂêåÊï∞ÊçÆÈõÜ‰∏äÁöÑcountÊìç‰ΩúÔºåËøô3‰∏™Actions‰ºöËß¶Âèë3‰∏™Spark Jobs„ÄÇÂÖ∂‰∏≠ÔºåÂâç2‰∏™JobsÈÉΩÊòØËØªÂèñÊï∞ÊçÆÊ∫ê‰πãÂêéÁ´ãÂç≥ËÆ°Êï∞ÔºåÊ≤°‰ªÄ‰πà‰ºòÂåñÁ©∫Èó¥„ÄÇÁ¨¨3‰∏™JobÊòØÂú®applyNumbersDF‰πã‰∏äÂÅöÂéªÈáçÔºåÁÑ∂ÂêéÂÜçÁªüËÆ°ËÆ°Êï∞„ÄÇÁªìÂêà‰∏ä‰∏ÄËÆ≤ÂØπ‰∫é‰∏çÂêåÊ°à‰æãÁöÑËÆ≤Ëß£ÔºåÊàë‰ª¨Áü•ÈÅìÔºåapplyNumbersDF„ÄÅluckyDogsDFÂíåapplyDistinctDFËøô3‰∏™Êï∞ÊçÆÈõÜÔºåÂú®ÂêéÁª≠ÁöÑÊ°à‰æã‰∏≠‰ºöË¢´ÂèçÂ§çÂºïÁî®„ÄÇ</p>
<p>Âõ†‰∏∫‰∏äËø∞3‰∏™Êï∞ÊçÆÈõÜÁöÑÂºïÁî®Ê¨°Êï∞Ëøá‰∫éÈ¢ëÁπÅÔºåÊâÄ‰ª•Êàë‰ª¨ÁîöËá≥ÈÉΩ‰∏çÁî®ÂéªËÆ°ÁÆó‚ÄúËøêË°åÊàêÊú¨Âç†ÊØî‚ÄùÔºåÂ∞±ÂèØ‰ª•Âà§ÂÆöÔºöÂà©Áî®Cache‰∏ÄÂÆöÊúâÂà©‰∫éÊèêÂçáÊâßË°åÊÄßËÉΩ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-tex" data-lang="tex"><span class="line"><span class="cl">‰ΩøÁî®CacheÁöÑ‰∏ÄËà¨ÊÄßÂéüÂàôÔºö- Â¶ÇÊûúRDD/DataFrame/DatasetÂú®Â∫îÁî®‰∏≠ÁöÑÂºïÁî®Ê¨°Êï∞‰∏∫1ÔºåÈÇ£‰πàÂùöÂÜ≥‰∏ç‰ΩøÁî®Cache- Â¶ÇÊûúÂºïÁî®Ê¨°Êï∞Â§ß‰∫é1Ôºå‰∏îËøêË°åÊàêÊú¨Âç†ÊØîË∂ÖËøá30<span class="c">%ÔºåÂ∫îÂΩìËÄÉËôëÂêØÁî®Cache
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†Ê≠§ÔºåÂØπ‰∫éÁ¨¨3‰∏™JobÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®CacheÊú∫Âà∂Êù•ÊèêÂçáÊâßË°åÊÄßËÉΩ„ÄÇË∞É‰ºòÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÊàë‰ª¨Âè™ÈúÄÂú®applyNumbersDF.count‰πãÂâçÊ∑ªÂä†‰∏ÄË°å‰ª£Á†ÅÔºöapplyNumbersDF.cache„ÄÇ</p>
<p>Áî±‰∫éËøô‰∏™Ê°à‰æã‰∏≠ÊÄßËÉΩÂØπÊØîÊµãËØïÁöÑÂÖ≥Ê≥®ÁÇπÊòØÁ¨¨3‰∏™JobÔºåÈÇ£‰∏∫‰∫ÜÊñπ‰æøÊ®™ÂêëÂØπÊØîÔºåÊàë‰ª¨ÂÖàÊää‰∏çÁõ∏Âπ≤ÁöÑJobsÂíå‰ª£Á†ÅÂéªÊéâÔºåÊï¥ÁêÜ‰πãÂêéÁöÑÂØπÊØîÂü∫ÂáÜÂíåË∞É‰ºò‰ª£Á†ÅÂ¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094623281-4508784.png"
	width="1610"
	height="798"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094623281-4508784_hu16367134057214566181.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094623281-4508784_hu7243887854153168829.png 1024w"
	loading="lazy"
	
		alt="image-20250413094623281"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="484px"
	
></p>
<p>ÁÑ∂ÂêéÔºåÊàë‰ª¨ÊääËøô‰∏§‰ªΩ‰ª£Á†ÅÂàÜÂà´ÊâìÂåÖ„ÄÅÈÉ®ÁΩ≤ÂíåÊâßË°åÔºåÂπ∂ËÆ∞ÂΩïapplyDistinctDF.count‰Ωú‰∏öÁöÑÊâßË°åÊó∂Èó¥ÔºåÊù•ÂÆåÊàêÊÄßËÉΩÂØπÊØîÊµãËØïÔºåÊàëÊääÊâßË°åÁªìÊûúËÆ∞ÂΩïÂà∞‰∫Ü‰∏ãÈù¢ÁöÑË°®Ê†º‰∏≠„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094648191.png"
	width="1608"
	height="538"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094648191_hu6662256585016452204.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413094648191_hu11070948439828009738.png 1024w"
	loading="lazy"
	
		alt="image-20250413094648191"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="717px"
	
></p>
<p>‰ªé‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÁõ∏ËæÉ‰∫éÂØπÊØîÂü∫ÂáÜÔºåË∞É‰ºò‰πãÂêéÁöÑÊâßË°åÊÄßËÉΩÊèêÂçá‰∫Ü20%„ÄÇÂù¶ÁôΩÂú∞ËØ¥ÔºåËøôÊ†∑ÁöÑÊèêÂçáÊòØÊàë‰ª¨ÊÑèÊñô‰πã‰∏≠ÁöÑ„ÄÇÊØïÁ´üÂâçËÄÖÊ∂àËÄóÁöÑÊòØÁ£ÅÁõòI/OÔºåËÄåË∞É‰ºò‰πãÂêéËÆ°Êï∞‰Ωú‰∏öÁõ¥Êé•‰ªéÂÜÖÂ≠òËé∑ÂèñÊï∞ÊçÆ„ÄÇ</p>
<h2 id="Ê°à‰æã2ÁöÑÊÄßËÉΩË∞É‰ºòÊëáÂè∑Ê¨°Êï∞ÂàÜÂ∏É">Ê°à‰æã2ÁöÑÊÄßËÉΩË∞É‰ºòÔºöÊëáÂè∑Ê¨°Êï∞ÂàÜÂ∏É
</h2><p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂÜçÊù•ÂàÜÊûêÊ°à‰æã2„ÄÇÊ°à‰æã2ÂàÜ‰∏∫‰∏§‰∏™Âú∫ÊôØÔºåÁ¨¨‰∏Ä‰∏™Âú∫ÊôØÁî®‰∫éÁªüËÆ°Áî≥ËØ∑ËÄÖÊëáÂè∑ÊâπÊ¨°Êï∞ÈáèÁöÑÂàÜÂ∏ÉÊÉÖÂÜµÔºåÁ¨¨‰∫å‰∏™Âú∫ÊôØ‰πüÊòØÁ±ª‰ººÔºå‰∏çËøáÂÆÉÁöÑÂá∫ÂèëÁÇπÊòØ‰∏≠Á≠æËÄÖÔºå‰∏ªË¶ÅÁî®Êù•Ëß£Á≠î‚Äú‰∏≠Á≠æËÄÖÈÄöÂ∏∏ÈúÄË¶ÅÊëáÂ§öÂ∞ëÊ¨°Âè∑ÊâçËÉΩ‰∏≠Á≠æ‚ÄùËøôÁ±ªÈóÆÈ¢ò„ÄÇ</p>
<h3 id="Âú∫ÊôØ1ÂèÇ‰∏éÊëáÂè∑ÁöÑÁî≥ËØ∑ËÄÖ">Âú∫ÊôØ1ÔºöÂèÇ‰∏éÊëáÂè∑ÁöÑÁî≥ËØ∑ËÄÖ
</h3><p>Êàë‰ª¨ÂÖàÊù•ÂõûÈ°æ‰∏Ä‰∏ãÂú∫ÊôØ1ÁöÑ‰ª£Á†ÅÂÆûÁé∞„ÄÇ‰ªîÁªÜÁ†îËØª‰ª£Á†ÅÔºåÊàë‰ª¨‰∏çÈöæÂèëÁé∞ÔºåÂú∫ÊôØ1ÊòØÂÖ∏ÂûãÁöÑÂçïË°®ShuffleÔºåËÄå‰∏îÊòØ‰∏§Ê¨°Shuffle„ÄÇÁ¨¨‰∏ÄÊ¨°ShuffleÊìç‰ΩúÊòØ‰ª•Êï∞ÊçÆÂàó‚ÄúcarNum‚Äù‰∏∫Âü∫ÂáÜÂÅöÂàÜÁªÑËÆ°Êï∞ÔºåÁ¨¨‰∫åÊ¨°ShuffleÊòØÊåâÁÖß‚Äúx_axis‚ÄùÂàóÂÜçÊ¨°ÂÅöÂàÜÁªÑËÆ°Êï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">val</span> <span class="n">result02_01</span> <span class="k">=</span> <span class="n">applyDistinctDF</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&#34;carNum&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">agg</span><span class="o">(</span><span class="n">count</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="n">alias</span><span class="o">(</span><span class="s">&#34;x_axis&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&#34;x_axis&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">agg</span><span class="o">(</span><span class="n">count</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="n">alias</span><span class="o">(</span><span class="s">&#34;y_axis&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="s">&#34;x_axis&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">result02_01</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&#34;csv&#34;</span><span class="o">).</span><span class="n">save</span><span class="o">(</span><span class="s">&#34;_&#34;</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†Ê≠§ÔºåÂú∫ÊôØ1ÁöÑËÆ°ÁÆóÂÆûÈôÖ‰∏äÂ∞±ÊòØ2Ê¨°Word CountËÄåÂ∑≤ÔºåÂè™‰∏çËøáÁ¨¨‰∏ÄÊ¨°ÁöÑWordÊòØ‚ÄúcarNum‚ÄùÔºåËÄåÁ¨¨‰∫åÊ¨°ÁöÑWordÊòØ‚Äúx_axis‚Äù„ÄÇÈÇ£‰πàÔºåÂØπ‰∫éËøôÊ†∑ÁöÑ‚ÄúWord Count‚ÄùÔºåÊàë‰ª¨ÈÉΩÊúâÂì™‰∫õË∞É‰ºòÊÄùË∑ØÂë¢Ôºü</p>
<p>Âú®ÈÖçÁΩÆÈ°πË∞É‰ºòÈÇ£‰∏ÄËÆ≤ÔºåÊàë‰ª¨‰∏ìÈó®‰ªãÁªç‰∫ÜShuffleË∞É‰ºòÁöÑ‰∏Ä‰∫õÂ∏∏ËßÑÊñπÊ≥ïÔºåÊØîÂ¶ÇË∞ÉÊï¥ËØªÂÜôÁºìÂÜ≤Âå∫Â§ßÂ∞è„ÄÅBy PassÊéíÂ∫èÊìç‰ΩúÁ≠âÁ≠â„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÊàë‰ª¨ÁöÑËÑëÂ≠êÈáå‰∏ÄÂÆöË¶ÅÊúâ‰∏ÄÊ†πÂº¶ÔºöShuffleÁöÑÊú¨Ë¥®ÊòØÊï∞ÊçÆÁöÑÈáçÊñ∞ÂàÜÂèëÔºåÂá°ÊòØÊúâShuffleÊìç‰ΩúÁöÑÂú∞ÊñπÈÉΩÈúÄË¶ÅÂÖ≥Ê≥®Êï∞ÊçÆÂàÜÂ∏É„ÄÇÊâÄ‰ª•ÂØπ‰∫éËøáÂ∞èÁöÑÊï∞ÊçÆÂàÜÁâáÔºåÊàë‰ª¨Ë¶ÅÊúâÊÑèËØÜÂú∞ÂØπÂÖ∂ËøõË°åÂêàÂπ∂„ÄÇÂÜçËÄÖÔºåÂú®Ê°à‰æã1‰∏≠Êàë‰ª¨ÊèêÂà∞ÔºåapplyNumbersDF„ÄÅluckyDogsDFÂíåapplyDistinctDFÂú®ÂêéÁª≠ÁöÑÊ°à‰æã‰∏≠‰ºöË¢´ÂèçÂ§çÂºïÁî®ÔºåÂõ†Ê≠§ÁªôapplyDistinctDFÂä†Cache‰πüÊòØ‰∏Ä‰ª∂È°∫ÁêÜÊàêÁ´†ÁöÑ‰∫ãÊÉÖ„ÄÇ</p>
<p>Ë∞É‰ºòÁöÑÊÄùË∑ØËøô‰πàÂ§öÔºåÈÇ£‰∏∫‰∫ÜÊºîÁ§∫ÊØè‰∏ÄÁßçË∞É‰ºòÊñπÊ≥ïÁöÑÊèêÂçáÊïàÊûúÔºåÊàë‰ºö‰ªéÂ∏∏ËßÑÊìç‰Ωú„ÄÅÊï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂„ÄÅÂä†CacheËøô3‰∏™ÊñπÂêëÂá∫ÂèëÔºåÂàÜÂà´ÂØπÂú∫ÊôØ1ËøõË°åÊÄßËÉΩË∞É‰ºò„ÄÇ‰∏çËøáÔºåÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºåÂí±‰ª¨Ëøô‰πàÂÅöÁöÑÁõÆÁöÑÔºå‰∏ÄÊù•ÊòØ‰∏∫‰∫ÜÂºÄÈòîË∞É‰ºòÊÄùË∑ØÔºå‰∫åÊù•ÊòØ‰∏∫‰∫ÜÂ§ç‰π†‰πãÂâçÂ≠¶‰π†ËøáÁöÑË∞É‰ºòÊäÄÂ∑ß„ÄÇ</p>
<p>ÂΩìÁÑ∂‰∫ÜÔºåÂú®ÂÆûÈôÖÂ∑•‰Ωú‰∏≠ÔºåÊàë‰ª¨‰∏ÄËà¨Ê≤°ÊúâÊó∂Èó¥ÂíåÁ≤æÂäõÂÉèÁé∞Âú®ËøôÊ†∑Ôºå‰∏Ä‰∏™ÊñπÊ≥ï„ÄÅ‰∏Ä‰∏™ÊñπÊ≥ïÂéªÂ∞ùËØï„ÄÇÈÇ£‰πàÔºåÊïàÁéáÊúÄÈ´òÁöÑÂÅöÊ≥ïÂ∫îËØ•ÊòØÈÅµÂæ™Êàë‰ª¨‰∏ÄÁõ¥Âº∫Ë∞ÉÁöÑË∞É‰ºòÊñπÊ≥ïËÆ∫Ôºå‰πüÂ∞±ÊòØÂÖàÂéªÂ∫îÂØπÊú®Ê°∂ÁöÑÁü≠Êùø„ÄÅÊ∂àÈô§Áì∂È¢àÔºå‰ºòÂÖàËß£ÂÜ≥‰∏ªË¶ÅÁüõÁõæÔºåÁÑ∂ÂêéÂú®Êó∂Èó¥„ÄÅÁ≤æÂäõÂÖÅËÆ∏ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÜçÂéªÂ∫îÂØπÊ¨°Áü≠ÁöÑÊú®Êùø„ÄÇ</p>
<p>ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºå‰Ω†ËÆ§‰∏∫‰∏äËø∞3ÁßçË∞É‰ºòÊÄùË∑ØÂàÜÂà´Â∫îÂØπÁöÑÊòØÂì™‰∫õ‚ÄúÊú®Êùø‚ÄùÔºüËøô‰∫õ‚ÄúÊú®Êùø‚Äù‰∏≠Âì™‰∏ÄÂùóÊòØÊúÄÁü≠ÁöÑÔºü‰Ω†Âèà‰ºö‰ºòÂÖàÈááÁî®Âì™ÁßçË∞É‰ºòÊäÄÂ∑ßÔºüÊé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞±Â∏¶ÁùÄËøô‰∫õÈóÆÈ¢òÔºå‰æùÊ¨°ÂØπÂú∫ÊôØ1ÂÅöË∞É‰ºò„ÄÇ</p>
<h4 id="ÊÄùË∑Ø1shuffleÂ∏∏ËßÑ‰ºòÂåñ">ÊÄùË∑Ø1ÔºöShuffleÂ∏∏ËßÑ‰ºòÂåñ
</h4><p>ÂàöÂàöÂí±‰ª¨ÊèêÂà∞ÔºåShuffleÁöÑÂ∏∏ËßÑ‰ºòÂåñÊúâ‰∏§Á±ªÔºö‰∏ÄÁ±ªÊòØBy PassÊéíÂ∫èÊìç‰ΩúÔºå‰∏ÄÁ±ªÊòØË∞ÉÊï¥ËØªÂÜôÁºìÂÜ≤Âå∫„ÄÇËÄåBy PassÊéíÂ∫èÊúâ‰∏§‰∏™ÂâçÊèêÊù°‰ª∂Ôºö‰∏ÄÊòØËÆ°ÁÆóÈÄªËæë‰∏çÊ∂âÂèäËÅöÂêàÊàñÊéíÂ∫èÔºõ‰∫åÊòØReduceÈò∂ÊÆµÁöÑÂπ∂Ë°åÂ∫¶Ë¶ÅÂ∞è‰∫éÂèÇÊï∞spark.shuffle.sort.bypassMergeThresholdÁöÑËÆæÁΩÆÂÄº„ÄÇÊòæÁÑ∂ÔºåÂú∫ÊôØ1‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÔºåËÆ°ÁÆóÈÄªËæëÊó¢ÂåÖÂê´ËÅöÂêà‰πüÂåÖÂê´ÊéíÂ∫è„ÄÇÊâÄ‰ª•ÔºåÊàë‰ª¨Â∞±Âè™ÊúâË∞ÉÊï¥ËØªÂÜôÁºìÂÜ≤Âå∫Ëøô‰∏ÄÊù°Ë∑ØÂèØËµ∞‰∫Ü„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÔºåËØªÂÜôÁºìÂÜ≤Âå∫ÁöÑË∞É‰ºò‰πüÊòØÊúâÂâçÊèêÁöÑÔºåÂõ†‰∏∫ËøôÈÉ®ÂàÜÂÜÖÂ≠òÊ∂àËÄó‰ºöÂç†Áî®Execution MemoryÂÜÖÂ≠òÂå∫ÂüüÔºåÊâÄ‰ª•ÊèêÈ´òÁºìÂÜ≤Âå∫Â§ßÂ∞èÁöÑÂâçÊèêÊòØExecution MemoryÂÜÖÂ≠òÊØîËæÉÂÖÖË£ï„ÄÇÁî±‰∫éÂí±‰ª¨‰ΩøÁî®ÁöÑÁ°¨‰ª∂ËµÑÊ∫êÊØîËæÉÂº∫Âä≤ÔºåËÄå‰∏îÂ∞èÊ±ΩËΩ¶ÊëáÂè∑Êï∞ÊçÆÊï¥‰Ωì‰ΩìÈáèÂÅèÂ∞èÔºåÂõ†Ê≠§Âí±‰ª¨ËøòÊòØÊúâ‰∏Ä‰∫õ‚ÄúËµÑÊú¨‚ÄùÂØπËØªÂÜôÁºìÂÜ≤Âå∫ÂÅöË∞É‰ºòÁöÑ„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÊàë‰ª¨ÈúÄË¶ÅË∞ÉÊï¥Â¶Ç‰∏ã‰∏§‰∏™ÈÖçÁΩÆÈ°πÔºö</p>
<ul>
<li><strong>spark.shuffle.file.bufferÔºåMapÈò∂ÊÆµÂÜôÂÖ•ÁºìÂÜ≤Âå∫Â§ßÂ∞è</strong></li>
<li><strong>spark.reducer.maxSizeInFlightÔºåReduceÈò∂ÊÆµËØªÁºìÂÜ≤Âå∫Â§ßÂ∞è</strong></li>
</ul>
<p>Áî±‰∫éËØªÂÜôÁºìÂÜ≤Âå∫ÈÉΩÊòØ‰ª•Task‰∏∫Á≤íÂ∫¶ËøõË°åËÆæÁΩÆÁöÑÔºåÂõ†Ê≠§Ë∞ÉÊï¥Ëøô‰∏§‰∏™ÂèÇÊï∞ÁöÑÊó∂Êàë‰ª¨Ë¶ÅÂ∞èÂøÉ‰∏ÄÁÇπÔºå‰∏ÄËà¨Êù•ËØ¥50%ÂæÄÂæÄÊòØ‰∏™‰∏çÈîôÁöÑÂºÄÂßãÔºåÂØπÊØîÂü∫ÂáÜ‰∏é‰ºòÂåñËÆæÁΩÆÂ¶Ç‰∏ãË°®ÊâÄÁ§∫„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095007223.png"
	width="1590"
	height="316"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095007223_hu4837364022402970436.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095007223_hu5675522560139212652.png 1024w"
	loading="lazy"
	
		alt="image-20250413095007223"
	
	
		class="gallery-image" 
		data-flex-grow="503"
		data-flex-basis="1207px"
	
></p>
<p>‰∏§ÁªÑÂØπÊØîÂÆûÈ™åÁöÑËøêË°åÊó∂Èó¥ÔºåÊàëËÆ∞ÂΩïÂà∞‰∫Ü‰∏ãÈù¢ÁöÑË°®Ê†º‰∏≠„ÄÇ‰ªé‰∏≠Êàë‰ª¨‰∏çÈöæÂèëÁé∞Ôºå‰∏äËø∞‰∏§‰∏™ÂèÇÊï∞ÁöÑË∞ÉÊï¥ÔºåÂØπ‰∫é‰Ωú‰∏öÁ´ØÂà∞Á´ØÊâßË°åÊÄßËÉΩÁöÑÂΩ±Âìç‰∏çÂ§ß„ÄÇ‰∏çËøáÔºåËøôÁßçÂèÇÊï∞Ë∞É‰∫ÜÂçäÂ§©ÔºåÊâßË°åÊïàÁéáÂπ∂Ê≤°ÊúâÊòæËëóÊèêÂçáÁöÑÂú∫ÊôØÔºåËÇØÂÆöËÆ©‰Ω†‰ººÊõæÁõ∏ËØÜ„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊúÄÂ•ΩÁöÑÂäûÊ≥ïÂ∞±ÊòØÊàë‰ª¨ÁªßÁª≠ÂÄüÂä©‚ÄúÊú®Ê°∂Áü≠Êùø‚Äù‚ÄúÁì∂È¢à‚Äù‰ª•Âèä‚ÄúË∞É‰ºòÊñπÊ≥ïËÆ∫‚ÄùÔºåÂéªÂ∞ùËØïÂÖ∂‰ªñÁöÑË∞É‰ºòÊÄùË∑Ø„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095230813.png"
	width="1578"
	height="388"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095230813_hu13273497280115467077.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095230813_hu4160769378501849223.png 1024w"
	loading="lazy"
	
		alt="image-20250413095230813"
	
	
		class="gallery-image" 
		data-flex-grow="406"
		data-flex-basis="976px"
	
></p>
<h4 id="ÊÄùË∑Ø2Êï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂">ÊÄùË∑Ø2ÔºöÊï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂
</h4><p>Êé•ÁùÄÔºåÊàë‰ª¨ÂÜçÊù•ËØ¥Á¨¨‰∫å‰∏™ÊÄùË∑ØÔºåÊï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂„ÄÇÈ¶ñÂÖàÔºåÂí±‰ª¨ÂÖàÊù•‰∏ÄËµ∑ÂàÜÊûê‰∏Ä‰∏ãÔºåÂú∫ÊôØ1Âà∞Â∫ïÂ≠ò‰∏çÂ≠òÂú®Êï∞ÊçÆÂàÜÁâáËøáÂ∞èÁöÑÈóÆÈ¢ò„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂàÜÊûêÔºåÊàë‰ª¨ÂÜçÊù•ÂõûÈ°æ‰∏ÄÈÅç‰ª£Á†Å„ÄÇÂõ†‰∏∫Âú∫ÊôØ1ÁöÑËÆ°ÁÆóÂü∫‰∫éÊï∞ÊçÆÈõÜapplyDistinctDFÔºåÊâÄ‰ª•Ë¶ÅÂõûÁ≠îÂàöÂàöÁöÑÈóÆÈ¢òÔºåÊàë‰ª¨ÈúÄË¶ÅÁªìÂêàÊï∞ÊçÆÈõÜapplyDistinctDFÁöÑÂ≠òÂÇ®Â§ßÂ∞èÔºå‰ª•ÂèäShuffleËÆ°ÁÆóËøáÂêéReduceÈò∂ÊÆµÁöÑÂπ∂Ë°åÂ∫¶‰∏ÄËµ∑Êù•Áúã„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">val</span><span class="w"> </span><span class="n">result02_01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applyDistinctDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;y_axis&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result02_01</span><span class="p">.</span><span class="na">write</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;csv&#34;</span><span class="p">).</span><span class="na">save</span><span class="p">(</span><span class="s">&#34;_&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âπ∂Ë°åÂ∫¶Áî±ÈÖçÁΩÆÈ°πspark.sql.shuffle.partitionsÂÜ≥ÂÆöÔºåÂÖ∂ÈªòËÆ§Â§ßÂ∞è‰∏∫200Ôºå‰πüÂ∞±ÊòØ200‰∏™Êï∞ÊçÆÂàÜÂå∫„ÄÇËÄåÂØπ‰∫éÊï∞ÊçÆÈõÜÂ≠òÂÇ®Â§ßÂ∞èÁöÑ‰º∞ÁÆóÔºåÊàë‰ª¨ÈúÄË¶ÅÁî®Âà∞‰∏ãÈù¢ÁöÑÂáΩÊï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">def</span><span class="w"> </span><span class="nf">sizeNew</span><span class="p">(</span><span class="n">func</span><span class="p">:</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">DataFrame</span><span class="p">,</span><span class="w"> </span><span class="n">spark</span><span class="p">:</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SparkSession</span><span class="p">):</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">lp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">queryExecution</span><span class="p">.</span><span class="na">logical</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="na">sessionState</span><span class="p">.</span><span class="na">executePlan</span><span class="p">(</span><span class="n">lp</span><span class="p">).</span><span class="na">optimizedPlan</span><span class="p">.</span><span class="na">stats</span><span class="p">.</span><span class="na">sizeInBytes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;Estimated size: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="o">/</span><span class="n">1024</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;KB&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁªôÂÆöDataFrameÔºåsizeNewÂáΩÊï∞ÂèØ‰ª•ËøîÂõûËØ•Êï∞ÊçÆÈõÜÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÁ≤æÁ°ÆÂ§ßÂ∞è„ÄÇÊääapplyDistinctDF‰Ωú‰∏∫ÂÆûÂèÇÔºåË∞ÉÁî®sizeNewÂáΩÊï∞ÔºåËøîÂõûÁöÑ‰º∞ÁÆóÂ∞∫ÂØ∏‰∏∫2.6 GB„ÄÇÂ∞ÜÊï∞ÊçÆÈõÜÂ∞∫ÂØ∏Èô§‰ª•Âπ∂Ë°åÂ∫¶ÔºåÊàë‰ª¨Â∞±ËÉΩÂæóÂà∞ReduceÈò∂ÊÆµÊØè‰∏™Êï∞ÊçÆÂàÜÁâáÁöÑÂ≠òÂÇ®Â§ßÂ∞èÔºå‰πüÂ∞±ÊòØ13 MBÔºà‰πüÂ∞±ÊòØ2.6 GB / 200Ôºâ„ÄÇÈÄöÂ∏∏Êù•ËØ¥ÔºåÊï∞ÊçÆÂàÜÁâáÁöÑÂ∞∫ÂØ∏Â§ßÂ∞èÂú®200 MBÂ∑¶Âè≥‰∏∫ÂÆúÔºå13 MBÁöÑÂàÜÁâáÂ∞∫ÂØ∏ÊòæÁÑ∂ËøáÂ∞è„ÄÇ</p>
<p>Âú®Ë∞ÉÂ∫¶Á≥ªÁªüÈÇ£‰∏ÄËÆ≤ÔºàÁ¨¨5ËÆ≤ÔºâÔºåÊàë‰ª¨ËØ¥ËøáÔºåÂ¶ÇÊûúÈúÄË¶ÅÂ§ÑÁêÜÁöÑÊï∞ÊçÆÂàÜÁâáËøáÂ∞èÔºåÁõ∏ËæÉ‰∫éÊï∞ÊçÆÂ§ÑÁêÜÔºåTaskË∞ÉÂ∫¶ÂºÄÈîÄÂ∞ÜÂèòÂæóÂºÇÂ∏∏ÊòæËëóÔºåËÄåËøôÊ†∑‰ºöÂØºËá¥CPUÂà©Áî®Èôç‰ΩéÔºåÊâßË°åÊÄßËÉΩÂèòÂ∑Æ„ÄÇÂõ†Ê≠§Ôºå‰∏∫‰∫ÜÊèêÂçáCPUÂà©Áî®ÁéáËøõËÄåÊèêÂçáÊï¥‰ΩìÁöÑÊâßË°åÊïàÁéáÔºåÊàë‰ª¨ÈúÄË¶ÅÂØπËøáÂ∞èÁöÑÊï∞ÊçÆÂàÜÁâáÂÅöÂêàÂπ∂„ÄÇËøô‰∏™Êó∂ÂÄôÔºåAQEÁöÑËá™Âä®ÂàÜÂå∫ÂêàÂπ∂ÁâπÊÄßÂ∞±ÂèØ‰ª•Â∏ÆÊàë‰ª¨ÂÅöËøô‰ª∂‰∫ãÊÉÖ„ÄÇ</p>
<p>‰∏çËøáÔºåË¶ÅÊÉ≥ÂÖÖÂàÜÂà©Áî®AQEÁöÑËá™Âä®ÂàÜÂå∫ÂêàÂπ∂ÁâπÊÄßÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂØπÁõ∏ÂÖ≥ÁöÑÈÖçÁΩÆÈ°πËøõË°åË∞ÉÊï¥„ÄÇËøôÈáåÔºå‰Ω†Áõ¥Êé•ÁúãÂú∫ÊôØ1ÊòØÊÄé‰πàËÆæÁΩÆËøô‰∫õÈÖçÁΩÆÈ°πÁöÑÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095428635-4509270.png"
	width="1602"
	height="486"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095428635-4509270_hu14303222602755076199.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095428635-4509270_hu1006618950429646981.png 1024w"
	loading="lazy"
	
		alt="image-20250413095428635"
	
	
		class="gallery-image" 
		data-flex-grow="329"
		data-flex-basis="791px"
	
></p>
<p>‰∏ÄÊó¶ÂºÄÂêØAQEÊú∫Âà∂ÔºåËá™Âä®ÂàÜÂå∫ÂêàÂπ∂ÁâπÊÄß‰ºöËá™Âä®ÁîüÊïà„ÄÇË°®Ê†º‰∏≠ÁöÑÈÖçÁΩÆÈ°πÊúâ‰∏§‰∏™ÈúÄË¶ÅÊàë‰ª¨ÁâπÂà´Ê≥®ÊÑèÔºå‰∏Ä‰∏™ÊòØÊúÄÂ∞èÂàÜÂå∫Êï∞minPartitionNumÔºåÂè¶‰∏Ä‰∏™ÊòØÂêàÂπ∂‰πãÂêéÁöÑÁõÆÊ†áÂ∞∫ÂØ∏advisoryPartitionSizeInBytes„ÄÇ</p>
<p>Êàë‰ª¨ÂÖàÊù•ÁúãÊúÄÂ∞èÂàÜÂå∫Êï∞Ôºå‰πüÂ∞±ÊòØminPartitionNum„ÄÇminPartitionNumÁöÑÂê´‰πâÔºåÊåáÁöÑÊòØÂàÜÂå∫ÂêàÂπ∂‰πãÂêéÁöÑÂàÜÂå∫Êï∞ÈáèÔºå‰∏çËÉΩ‰Ωé‰∫éËøô‰∏™ÂèÇÊï∞ËÆæÁΩÆÁöÑÊï∞ÂÄº„ÄÇÁî±‰∫éÊàë‰ª¨ËÆ°ÁÆóÈõÜÁæ§ÈÖçÁΩÆÁöÑExecutors‰∏™Êï∞‰∏∫6Ôºå‰∏∫‰∫Ü‰øùËØÅÊØè‰∏™CPUÈÉΩ‰∏çÈó≤ÁùÄ„ÄÅÊúâÊ¥ªÂÑøÂπ≤ÔºåÊàë‰ª¨‰∏çÂ¶®ÊääminPartitionNum‰πüËÆæÁΩÆ‰∏∫6„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÊòØÂàÜÂå∫ÂêàÂπ∂ÁöÑÁõÆÊ†áÂ∞∫ÂØ∏ÔºåÊàë‰ª¨ÂàöÂàöËØ¥ËøáÔºåÂàÜÂå∫Â§ßÂ∞èÁöÑÁªèÈ™åÂÄºÂú®200 MBÂ∑¶Âè≥ÔºåÂõ†Ê≠§Êàë‰ª¨‰∏çÂ¶®ÊääadvisoryPartitionSizeInBytesËÆæÁΩÆ‰∏∫200 MB„ÄÇ‰∏çËøáÔºå‰∏∫‰∫ÜÂØπÊØî‰∏çÂêåÂàÜÂå∫Â§ßÂ∞èÂØπ‰∫éÊâßË°åÊÄßËÉΩÁöÑÂΩ±ÂìçÔºåÊàë‰ª¨ÂèØ‰ª•Â§öÂÅöÂá†ÁªÑÂÆûÈ™å„ÄÇ</p>
<p>ÈÖçÁΩÆÈ°πË∞ÉÊï¥ÂâçÂêéÁöÑÂá†ÁªÑÂÆûÈ™åÊïàÊûúÂØπÊØîÂ¶Ç‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞ÔºåË∞É‰ºòÂêéÁöÑËøêË°åÊó∂Èó¥ÊúâÊâÄÁº©Áü≠ÔºåËøôËØ¥ÊòéÂàÜÂå∫ÂêàÂπ∂ÂØπ‰∫éÊèêÂçáCPUÂà©Áî®ÁéáÂíå‰Ωú‰∏öÁöÑÊï¥‰ΩìÊâßË°åÊÄßËÉΩÊòØÊúâÂ∏ÆÂä©ÁöÑ„ÄÇ‰ªîÁªÜËßÇÂØü‰∏ãË°®ÔºåÊàë‰ª¨Ëá≥Â∞ëÊúâ3ÁÇπÊ¥ûÂØü„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095510516-4509312.png"
	width="1580"
	height="550"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095510516-4509312_hu5830753992484060574.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095510516-4509312_hu11529603220882057604.png 1024w"
	loading="lazy"
	
		alt="image-20250413095510516"
	
	
		class="gallery-image" 
		data-flex-grow="287"
		data-flex-basis="689px"
	
></p>
<ul>
<li><strong>Âπ∂Ë°åÂ∫¶ËøáÈ´ò„ÄÅÊï∞ÊçÆÂàÜÁâáËøáÂ∞èÔºåCPUË∞ÉÂ∫¶ÂºÄÈîÄ‰ºöÂèòÂ§ßÔºåÊâßË°åÊÄßËÉΩ‰πüÂèòÂ∑Æ„ÄÇ</strong></li>
<li><strong>ÂàÜÁâáÁ≤íÂ∫¶ÂàíÂàÜÂú®200 MBÂ∑¶Âè≥Êó∂ÔºåÊâßË°åÊÄßËÉΩÂæÄÂæÄÊòØÊúÄ‰ºòÁöÑ„ÄÇ</strong></li>
<li><strong>Âπ∂Ë°åÂ∫¶Ëøá‰Ωé„ÄÅÊï∞ÊçÆÂàÜÁâáËøáÂ§ßÔºåCPUÊï∞ÊçÆÂ§ÑÁêÜÂºÄÈîÄ‰πü‰ºöËøáÂ§ßÔºåÊâßË°åÊÄßËÉΩ‰ºöÈîêÂáè„ÄÇ</strong></li>
</ul>
<h4 id="ÊÄùË∑Ø3Âä†cache">ÊÄùË∑Ø3ÔºöÂä†Cache
</h4><p>ÊúÄÂêé‰∏Ä‰∏™ÊÄùË∑ØÊòØÂä†CacheÔºåËøô‰∏™Ë∞É‰ºòÊäÄÂ∑ß‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏ÁÆÄÂçïÔºåÊàë‰ª¨Âú®Ê°à‰æã1Â∑≤ÁªèÂÅöËøáÊºîÁ§∫ÔºåÂõ†Ê≠§ÔºåËøôÈáåÁõ¥Êé•ÁªôÂá∫‰ºòÂåñ‰ª£Á†ÅÂíåËøêË°åÁªìÊûú„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095605691.png"
	width="1606"
	height="828"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095605691_hu3500375660281395213.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095605691_hu9884864023486447157.png 1024w"
	loading="lazy"
	
		alt="image-20250413095605691"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="465px"
	
></p>
<p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂà©Áî®CacheÊú∫Âà∂ÂÅö‰ºòÂåñÔºå‰Ωú‰∏öÊâßË°åÊÄßËÉΩÊèêÂçáÂæóÈùûÂ∏∏ÊòæËëó„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095634677-4509395.png"
	width="1606"
	height="382"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095634677-4509395_hu1250823513401815348.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095634677-4509395_hu11979244771076088575.png 1024w"
	loading="lazy"
	
		alt="image-20250413095634677"
	
	
		class="gallery-image" 
		data-flex-grow="420"
		data-flex-basis="1009px"
	
></p>
<p>Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨Â∞ùËØï‰∫Ü3ÁßçË∞É‰ºòÊñπÊ≥ïÊù•ÂØπÂú∫ÊôØ1ÂÅöÊÄßËÉΩ‰ºòÂåñÔºåÂàÜÂà´ÊòØShuffleËØªÂÜôÁºìÂÜ≤Âå∫Ë∞ÉÊï¥„ÄÅÊï∞ÊçÆÂàÜÂå∫ÂêàÂπ∂Ôºå‰ª•ÂèäÂä†Cache„ÄÇÁ¨¨1ÁßçÊñπÊ≥ïÈíàÂØπÁöÑÊòØÔºåShuffleËøáÁ®ã‰∏≠Á£ÅÁõò‰∏éÁΩëÁªúÁöÑËØ∑Ê±ÇÊ¨°Êï∞ÔºõÁ¨¨2ÁßçÊñπÊ≥ïÁöÑ‰ºòÂåñÁõÆÊ†áÔºåÊòØÊèêÂçáReduceÈò∂ÊÆµÁöÑCPUÂà©Áî®ÁéáÔºõÁ¨¨3ÁßçÊñπÊ≥ïÈíàÂØπÁöÑÊòØÔºåÊï∞ÊçÆÈõÜÂú®Á£ÅÁõò‰∏≠ÁöÑÈáçÂ§çÊâ´Êèè‰∏éÈáçÂ§çËÆ°ÁÆó„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÔºåÊ†πÊú¨‰∏çÈúÄË¶ÅÂÅöÂÆöÈáèÂàÜÊûêÔºå‰ªÖ‰ªéÂÆöÊÄßÊàë‰ª¨Â∞±ËÉΩÁúãÂá∫ÔºåÊï∞ÊçÆÈõÜÁöÑÈáçÂ§çÊâ´Êèè‰∏éËÆ°ÁÆóÁöÑÂºÄÈîÄÊúÄÂ§ß„ÄÇÂõ†Ê≠§ÔºåÂú®ÂÆûÈôÖÂ∑•‰Ωú‰∏≠ÔºåÂØπ‰∫éÁ±ª‰ººÁöÑ‚ÄúÂ§öÈÄâÈ¢ò‚ÄùÔºåÊàë‰ª¨Ëá™ÁÑ∂Ë¶Å‰ºòÂÖàÈÄâÊã©ËÉΩÂ§üÊ∂àÈô§Áì∂È¢àÁöÑÁ¨¨3ÁßçÊñπÊ≥ï„ÄÇ</p>
<h3 id="Âú∫ÊôØ2Âπ∏ËøêÁöÑ‰∏≠Á≠æËÄÖ">Âú∫ÊôØ2ÔºöÂπ∏ËøêÁöÑ‰∏≠Á≠æËÄÖ
</h3><p>ÂÆåÊàê‰∫ÜÂú∫ÊôØ1ÂçïË°®ShuffleÁöÑ‰ºòÂåñ‰πãÂêéÔºåÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂÜçÊù•ÁúãÁúãÂú∫ÊôØ2ÔºåÂú∫ÊôØ2ÁöÑ‰∏öÂä°ÁõÆÊ†áÊòØËé∑Âèñ‰∏≠Á≠æËÄÖÁöÑÊëáÂè∑Ê¨°Êï∞ÂàÜÂ∏É„ÄÇÊàë‰ª¨ÂÖàÊù•ÂõûÈ°æÂú∫ÊôØ2ÁöÑ‰ª£Á†ÅÂÆûÁé∞ÔºåÂú∫ÊôØ2ÁöÑËÆ°ÁÆóÊ∂âÂèä‰∏ÄÊ¨°Êï∞ÊçÆÂÖ≥ËÅîÔºå‰∏§Ê¨°ÂàÜÁªÑ„ÄÅËÅöÂêàÔºå‰ª•ÂèäÊúÄÁªàÁöÑÊéíÂ∫èÊìç‰Ωú„ÄÇ‰∏çÈöæÂèëÁé∞ÔºåÈô§‰∫ÜÂÖ≥ËÅîËÆ°ÁÆóÂ§ñÔºåÂÖ∂‰ªñËÆ°ÁÆóÊ≠•È™§‰∏éÂú∫ÊôØ1Â¶ÇÂá∫‰∏ÄËæô„ÄÇÂõ†Ê≠§ÔºåÂØπ‰∫éÂú∫ÊôØ2ÁöÑ‰ºòÂåñÔºåÊàë‰ª¨‰∏ìÊ≥®Âú®Á¨¨‰∏ÄÊ≠•ÁöÑÊï∞ÊçÆÂÖ≥ËÅîÔºåÂêéÁª≠‰ºòÂåñÊ≤øÁî®Âú∫ÊôØ1ÁöÑË∞É‰ºòÊñπÊ≥ïÂç≥ÂèØ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">val</span><span class="w"> </span><span class="n">result02_02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applyDistinctDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">luckyDogsDF</span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">Seq</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="s">&#34;inner&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">)).</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">)).</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;y_axis&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="s">&#34;x_axis&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result02_02</span><span class="p">.</span><span class="na">write</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;csv&#34;</span><span class="p">).</span><span class="na">save</span><span class="p">(</span><span class="s">&#34;_&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèÇ‰∏éÂÖ≥ËÅîÁöÑ‰∏§Âº†Ë°®ÂàÜÂà´ÊòØapplyDistinctDFÂíåluckyDogsDFÔºåÂÖ∂‰∏≠applyDistinctDFÊòØÂéªÈáç‰πãÂêéÁöÑÊëáÂè∑Êï∞ÊçÆÔºåluckyDogsDFÂåÖÂê´ÁöÑÊòØ‰∏≠Á≠æËÄÖÁöÑÁî≥ËØ∑ÁºñÂè∑‰∏éÊâπÊ¨°Âè∑„ÄÇapplyDistinctDFÂåÖÂê´1.35Êù°Êï∞ÊçÆËÆ∞ÂΩïÔºåËÄåluckyDogsDF‰ªÖ‰ªÖÂåÖÂê´115‰∏áÊù°Êï∞ÊçÆËÆ∞ÂΩï„ÄÇÂæàÊòæÁÑ∂Ôºå‰∫åËÄÖ‰πãÈó¥ÁöÑÊï∞ÊçÆÂÖ≥ËÅîÂ±û‰∫éÊï∞‰ªì‰∏≠Â∏∏ËßÅÁöÑ‚ÄúÂ§ßË°®JoinÂ∞èË°®‚Äù„ÄÇ</p>
<p>ÈÅáÂà∞‚ÄúÂ§ßË°®JoinÂ∞èË°®‚ÄùÁöÑËÆ°ÁÆóÂú∫ÊôØÔºåÊàë‰ª¨ÊúÄÂÖàÂ∫îËØ•ÊÉ≥Âà∞ÁöÑË∞É‰ºòÊäÄÂ∑ß‰∏ÄÂÆöÊòØÂπøÊí≠ÂèòÈáè„ÄÇÊØïÁ´üÔºåÊàë‰ª¨‰∏ÄÁõ¥ÈÉΩÂú®‰∏çÈÅó‰ΩôÂäõÂú∞Âº∫Ë∞ÉBroadcast JoinsÁöÑ‰ºòÂäø‰∏éÊî∂Áõä„ÄÇÂú®ËøôÈáåÔºåÊàëÂÜçÂº∫Ë∞É‰∏ÄÊ¨°Ôºå‰Ω†‰∏ÄÂÆöË¶ÅÊéåÊè°‰ΩøÁî®ÂπøÊí≠ÂèòÈáè‰ºòÂåñÊï∞ÊçÆÂÖ≥ËÅîÁöÑË∞É‰ºòÊäÄÂ∑ß„ÄÇÊØ´‰∏çÂ§∏Âº†Âú∞ËØ¥ÔºåÂπøÊí≠ÂèòÈáèÊòØ‚ÄúÊÄß‰ª∑ÊØî‚ÄùÊúÄÈ´òÁöÑË∞É‰ºòÊäÄÂ∑ßÔºå‰∏îÊ≤°Êúâ‰πã‰∏Ä„ÄÇ</p>
<p>Ë¶ÅÂà©Áî®ÂπøÊí≠ÂèòÈáèÊù•‰ºòÂåñapplyDistinctDF‰∏éluckyDogsDFÁöÑÂÖ≥ËÅîËÆ°ÁÆóÔºåÊàë‰ª¨ÈúÄË¶ÅÂÅö‰∏§‰ª∂‰∫ãÊÉÖ„ÄÇÁ¨¨‰∏Ä‰ª∂Ôºå‰º∞ÁÆóluckyDogsDFÊï∞ÊçÆË°®Âú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®Â§ßÂ∞è„ÄÇÁ¨¨‰∫å‰ª∂ÔºåËÆæÁΩÆÂπøÊí≠ÈòàÂÄºÈÖçÁΩÆÈ°πspark.sql.autoBroadcastJoinThreshold„ÄÇ</p>
<p>ÂØπ‰∫éÂàÜÂ∏ÉÂºèÊï∞ÊçÆÈõÜÁöÑÂ∞∫ÂØ∏È¢Ñ‰º∞ÔºåÊàë‰ª¨ËøòÊòØ‰ΩøÁî®sizeNewÂáΩÊï∞ÔºåÊääluckyDogsDF‰Ωú‰∏∫ÂÆûÂèÇÔºåË∞ÉÁî®sizeNewÂáΩÊï∞ÔºåËøîÂõûÁöÑ‰º∞ÁÆóÂ∞∫ÂØ∏‰∏∫18.5MB„ÄÇÊúâ‰∫ÜËøô‰∏™ÂèÇËÄÉÂÄºÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ËÆæÁΩÆÂπøÊí≠ÈòàÂÄº‰∫Ü„ÄÇË¶ÅÊääapplyDistinctDF‰∏éluckyDogsDFÁöÑÂÖ≥ËÅîËÆ°ÁÆóËΩ¨Âåñ‰∏∫Broadcast JoinÔºåÂè™Ë¶ÅËÆ©ÂπøÊí≠ÈòàÂÄºÂ§ß‰∫é18.5MBÂ∞±ÂèØ‰ª•ÔºåÊàë‰ª¨‰∏çÂ¶®ÊääËøô‰∏™ÂèÇÊï∞ËÆæÁΩÆ‰∏∫20MB„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095753582-4509474.png"
	width="1584"
	height="308"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095753582-4509474_hu11308866889565771756.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095753582-4509474_hu12057021047935399441.png 1024w"
	loading="lazy"
	
		alt="image-20250413095753582"
	
	
		class="gallery-image" 
		data-flex-grow="514"
		data-flex-basis="1234px"
	
></p>
<p>ÊàëÊääÈÖçÁΩÆÈ°πË∞ÉÊï¥ÂâçÂêéÁöÑÂÆûÈ™åÁªìÊûúËÆ∞ÂΩïÂà∞‰∫ÜÂ¶Ç‰∏ãË°®Ê†ºÔºåÊòæÁÑ∂ÔºåÁõ∏ÊØîÈªòËÆ§ÁöÑShuffle Sort Merge JoinÂÆûÁé∞Êú∫Âà∂ÔºåBroadcast JoinÁöÑÊâßË°åÊÄßËÉΩÊõ¥ËÉú‰∏ÄÁ≠π„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095812191-4509493.png"
	width="1596"
	height="440"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095812191-4509493_hu9466953629072805105.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413095812191-4509493_hu7607858951518907514.png 1024w"
	loading="lazy"
	
		alt="image-20250413095812191"
	
	
		class="gallery-image" 
		data-flex-grow="362"
		data-flex-basis="870px"
	
></p>
<h2 id="Ê°à‰æã3ÁöÑÊÄßËÉΩË∞É‰ºò‰∏≠Á≠æÁéáÁöÑÂèòÂåñË∂ãÂäø">Ê°à‰æã3ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∏≠Á≠æÁéáÁöÑÂèòÂåñË∂ãÂäø
</h2><p>Ê°à‰æã3ÁöÑ‰∏öÂä°ÁõÆÊ†áÊòØÊ¥ûÂØü‰∏≠Á≠æÁéáÁöÑÂèòÂåñË∂ãÂäøÔºåÊàë‰ª¨ÂÖàÊù•ÂõûÈ°æ‰ª£Á†Å„ÄÇË¶ÅËÆ°ÁÆó‰∏≠Á≠æÁéáÔºåÊàë‰ª¨ÈúÄË¶ÅÂàÜ‰∏§Ê≠•Ëµ∞„ÄÇÁ¨¨‰∏ÄÊ≠•ÔºåÊåâÁÖßÊëáÂè∑ÊâπÊ¨°Ôºå‰πüÂ∞±ÊòØbatchNumÂàÜÂà´ÂØπapplyDistinctDFÂíåluckyDogsDFÂàÜÁªÑÔºåÁÑ∂ÂêéÂàÜÂà´ÂØπÂàÜÁªÑÂÜÖÁöÑÁî≥ËØ∑ËÄÖÂíå‰∏≠Á≠æËÄÖÂÅöÁªüËÆ°ËÆ°Êï∞„ÄÇÁ¨¨‰∫åÊ≠•ÔºåÈÄöËøáÊï∞ÊçÆÂÖ≥ËÅîÂ∞Ü‰∏§Á±ªËÆ°Êï∞ÂÅöÈô§Ê≥ïÔºåÊúÄÁªàÂæóÂà∞ÊØè‰∏™ÊâπÊ¨°ÁöÑ‰∏≠Á≠æÁéá„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// ÁªüËÆ°ÊØèÊâπÊ¨°Áî≥ËØ∑ËÄÖÁöÑ‰∫∫Êï∞</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">val</span><span class="w"> </span><span class="n">apply_denominator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applyDistinctDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;denominator&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ÁªüËÆ°ÊØèÊâπÊ¨°‰∏≠Á≠æËÄÖÁöÑ‰∫∫Êï∞</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">val</span><span class="w"> </span><span class="n">lucky_molecule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luckyDogsDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;molecule&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">val</span><span class="w"> </span><span class="n">result03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apply_denominator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">lucky_molecule</span><span class="p">,</span><span class="w"> </span><span class="n">Seq</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="s">&#34;inner&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">withColumn</span><span class="p">(</span><span class="s">&#34;ratio&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;molecule&#34;</span><span class="p">)</span><span class="o">/</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;denominator&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">5</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result03</span><span class="p">.</span><span class="na">write</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;csv&#34;</span><span class="p">).</span><span class="na">save</span><span class="p">(</span><span class="s">&#34;_&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Áî±‰∫é2011Âπ¥Âà∞2019Âπ¥ÊÄªÂÖ±Êúâ72‰∏™ÊëáÂè∑ÊâπÊ¨°ÔºåÂõ†Ê≠§Á¨¨‰∏ÄÊ≠•ËÆ°ÁÆóÂæóÂà∞ÁªìÊûúÈõÜÔºå‰πüÂ∞±ÊòØapply_denominatorÂíålucky_moleculeÂêÑËá™Êúâ72Êù°Êï∞ÊçÆËÆ∞ÂΩï„ÄÇÊòæÁÑ∂Ôºå‰∏§‰∏™Â¶ÇÊ≠§‰πãÂ∞èÁöÑÊï∞ÊçÆÈõÜÂÅöÂÖ≥ËÅî‰∏çÂ≠òÂú®‰ªÄ‰πàË∞É‰ºòÁ©∫Èó¥„ÄÇ</p>
<p>Âõ†Ê≠§ÔºåÂØπ‰∫éÊ°à‰æã3Êù•ËØ¥ÔºåË∞É‰ºòÁöÑÂÖ≥ÈîÆÂú®‰∫éÁ¨¨‰∏ÄÊ≠•Ê∂âÂèäÁöÑ‰∏§‰∏™ÂçïË°®Shuffle„ÄÇÂÖ≥‰∫éÂçïË°®ShuffleÁöÑË∞É‰ºòÊÄùË∑Ø‰∏éÊäÄÂ∑ßÔºåÊàë‰ª¨Âú®Ê°à‰æã2ÁöÑÂú∫ÊôØ1ÂÅöËøáËØ¶ÁªÜÁöÑÂàÜÊûê‰∏éËÆ≤Ëß£ÔºåÂõ†Ê≠§ÔºåapplyDistinctDFÂíåluckyDogsDF‰∏§Âº†Ë°®ÁöÑShuffle‰ºòÂåñÂ∞±ÁïôÁªô‰Ω†‰Ωú‰∏∫ËØæÂêéÁªÉ‰π†‰∫Ü„ÄÇ</p>
<h2 id="Ê°à‰æã4ÁöÑÊÄßËÉΩË∞É‰ºò‰∏≠Á≠æÁéáÂ±ÄÈÉ®Ê¥ûÂØü">Ê°à‰æã4ÁöÑÊÄßËÉΩË∞É‰ºòÔºö‰∏≠Á≠æÁéáÂ±ÄÈÉ®Ê¥ûÂØü
</h2><p>‰∏éÊ°à‰æã3‰∏çÂêåÔºåÊ°à‰æã4Âè™ÂÖ≥Ê≥®2018Âπ¥ÁöÑ‰∏≠Á≠æÁéáÂèòÂåñË∂ãÂäøÔºåÊàë‰ª¨ÂÖàÊù•ÂõûÈ°æÊ°à‰æã4ÁöÑ‰ª£Á†ÅÂÆûÁé∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Á≠õÈÄâÂá∫2018Âπ¥ÁöÑ‰∏≠Á≠æÊï∞ÊçÆÔºåÂπ∂ÊåâÁÖßÊâπÊ¨°ÁªüËÆ°‰∏≠Á≠æ‰∫∫Êï∞</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">val</span><span class="w"> </span><span class="n">lucky_molecule_2018</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luckyDogsDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">).</span><span class="na">like</span><span class="p">(</span><span class="s">&#34;2018%&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;molecule&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ÈÄöËøá‰∏éÁ≠õÈÄâÂá∫ÁöÑ‰∏≠Á≠æÊï∞ÊçÆÊåâÁÖßÊâπÊ¨°ÂÅöÂÖ≥ËÅîÔºåËÆ°ÁÆóÊØèÊúüÁöÑ‰∏≠Á≠æÁéá</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">val</span><span class="w"> </span><span class="n">result04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apply_denominator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">lucky_molecule_2018</span><span class="p">,</span><span class="w"> </span><span class="n">Seq</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="s">&#34;inner&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">withColumn</span><span class="p">(</span><span class="s">&#34;ratio&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;molecule&#34;</span><span class="p">)</span><span class="o">/</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;denominator&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">5</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result04</span><span class="p">.</span><span class="na">write</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;csv&#34;</span><span class="p">).</span><span class="na">save</span><span class="p">(</span><span class="s">&#34;_&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰ª£Á†ÅÂÆûÁé∞Êù•ÁúãÔºåÊ°à‰æã4Áõ∏ÊØîÊ°à‰æã3ÂîØ‰∏ÄÁöÑÊîπÂä®ÔºåÂ∞±ÊòØÂú®luckyDogsDFÂÅöÁªüËÆ°ËÆ°Êï∞‰πãÂâçÂ¢ûÂä†‰∫ÜÊëáÂè∑ÊâπÊ¨°ÁöÑËøáÊª§Êù°‰ª∂Ôºå‰πüÂ∞±ÊòØfilter(col(‚ÄúbatchNum‚Äù).like(‚Äú2018%‚Äù))„ÄÇ‰Ω†ÂèØËÉΩ‰ºöËØ¥Ôºö‚ÄúÊ°à‰æã4ÁöÑÊîπÂä®ÂèØ‰ª•ËØ¥ÊòØÂæÆ‰πéÂÖ∂ÂæÆÔºåÂÆÉÁöÑË∞É‰ºòÁ©∫Èó¥ÂíåË∞É‰ºòÊñπÊ≥ïÂ∫îËØ•ÂíåÊ°à‰æã3Ê≤°Âï•Âå∫Âà´‚Äù„ÄÇËøòÁúü‰∏çÊòØÔºåËøòËÆ∞ÂæóSpark 3.0Êé®Âá∫ÁöÑDPPÊñ∞ÁâπÊÄßÂêóÔºüÊ∑ªÂä†Âú®luckyDogsDFË°®‰∏äÁöÑËøô‰∏™‰∏çËµ∑ÁúºÁöÑËøáÊª§Ë∞ìËØçÔºåÊÅ∞ÊÅ∞ËÆ©DPPÊúâ‰∫ÜÁî®Ê≠¶‰πãÂú∞„ÄÇ</p>
<p>Âú®DPPÈÇ£‰∏ÄËÆ≤ÔºåÊàë‰ª¨‰ªãÁªçËøáÂºÄÂêØDPPÁöÑ3‰∏™ÂâçÊèêÊù°‰ª∂Ôºö</p>
<ul>
<li>‰∫ãÂÆûË°®ÂøÖÈ°ªÊòØÂàÜÂå∫Ë°®Ôºå‰∏îÂàÜÂå∫Â≠óÊÆµÔºàÂèØ‰ª•ÊòØÂ§ö‰∏™ÔºâÂøÖÈ°ªÂåÖÂê´Join Key</li>
<li>DPP‰ªÖÊîØÊåÅÁ≠âÂÄºJoinsÔºå‰∏çÊîØÊåÅÂ§ß‰∫é„ÄÅÂ∞è‰∫éËøôÁßç‰∏çÁ≠âÂÄºÂÖ≥ËÅîÂÖ≥Á≥ª</li>
<li>Áª¥Ë°®ËøáÊª§‰πãÂêéÁöÑÊï∞ÊçÆÈõÜÔºåÂøÖÈ°ªË¶ÅÂ∞è‰∫éÂπøÊí≠ÈòàÂÄºÔºåÂõ†Ê≠§Ôºå‰Ω†Ë¶ÅÊ≥®ÊÑèË∞ÉÊï¥ÈÖçÁΩÆÈ°πspark.sql.autoBroadcastJoinThreshold</li>
</ul>
<p>ÈÇ£‰πàÔºåËøô3‰∏™ÂâçÊèêÊù°‰ª∂ÊòØÊÄé‰πàÂΩ±ÂìçÊ°à‰æã4ÁöÑÊÄßËÉΩË∞É‰ºòÁöÑÂë¢Ôºü</p>
<p>È¶ñÂÖàÔºåÂú®‰∏ä‰∏ÄËÆ≤ÔºåÊàë‰ª¨‰ªãÁªçËøáÊëáÂè∑Êï∞ÊçÆÁöÑÁõÆÂΩïÁªìÊûÑÔºåapplyÂíåluckyÁõÆÂΩï‰∏ãÁöÑÊï∞ÊçÆÈÉΩÊåâÁÖßbatchNumÂàóÂÅö‰∫ÜÂàÜÂå∫Â≠òÂÇ®„ÄÇÂõ†Ê≠§ÔºåÊ°à‰æã4‰∏≠ÂèÇ‰∏éÂÖ≥ËÅîÁöÑÊï∞ÊçÆË°®applyDistinctDFÂíåluckyDogsDFÈÉΩÊòØÂàÜÂå∫Ë°®Ôºå‰∏îÂàÜÂå∫ÈîÆbatchNumÂàöÂ•ΩÊòØ‰∫åËÄÖÂÅöÂÖ≥ËÅîËÆ°ÁÆóÁöÑJoin Key„ÄÇÂÖ∂Ê¨°ÔºåÊ°à‰æã4‰∏≠ÁöÑÂÖ≥ËÅîËÆ°ÁÆóÊòæÁÑ∂ÊòØÁ≠âÂÄºJoin„ÄÇ</p>
<p>ÊúÄÂêéÔºåÊàë‰ª¨Âè™Ë¶Å‰øùËØÅlucky_molecule_2018ÁªìÊûúÈõÜÂ∞è‰∫éÂπøÊí≠ÈòàÂÄºÂ∞±ÂèØ‰ª•Ëß¶ÂèëDPPÊú∫Âà∂„ÄÇ2018Âπ¥Âè™Êúâ6Ê¨°ÊëáÂè∑Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂàÜÁªÑËÆ°Êï∞ÂæóÂà∞ÁöÑlucky_molecule_2018Âè™Êúâ6Êù°Êï∞ÊçÆËÆ∞ÂΩïÔºåËøô‰πàÂ∞èÁöÑ‚ÄúÊï∞ÊçÆÈõÜ‚ÄùÂÆåÂÖ®ÂèØ‰ª•ÊîæËøõÂπøÊí≠ÂèòÈáè„ÄÇ</p>
<p>Â¶ÇÊ≠§‰∏ÄÊù•ÔºåÊ°à‰æã4Êª°Ë∂≥‰∫ÜDPPÊâÄÊúâÁöÑÂâçÊèêÊù°‰ª∂ÔºåÂà©Áî®DPPÊú∫Âà∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÂáèÂ∞ëapplyDistinctDFÁöÑÊï∞ÊçÆÊâ´ÊèèÈáèÔºå‰ªéËÄåÂú®Êï¥‰Ωì‰∏äÊèêÂçá‰Ωú‰∏öÁöÑÊâßË°åÊÄßËÉΩ„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100522049-4509923.png"
	width="1592"
	height="476"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100522049-4509923_hu922719157353639088.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100522049-4509923_hu10716624258416527384.png 1024w"
	loading="lazy"
	
		alt="image-20250413100522049"
	
	
		class="gallery-image" 
		data-flex-grow="334"
		data-flex-basis="802px"
	
></p>
<p>DPPÁöÑÊ†∏ÂøÉ‰ΩúÁî®Âú®‰∫éÈôç‰Ωé‰∫ãÂÆûË°®applyDistinctDFÁöÑÁ£ÅÁõòÊâ´ÊèèÈáèÔºåÂõ†Ê≠§Ê°à‰æã4ÁöÑË∞É‰ºòÂäûÊ≥ïÈùûÂ∏∏ÁÆÄÂçïÔºåÂè™Ë¶ÅÊääÊúÄÂàùÂä†Âú®applyDistinctDF‰πã‰∏äÁöÑCacheÂéªÊéâÂç≥ÂèØÔºåÂ¶Ç‰∏äË°®Âè≥‰æßÊâÄÁ§∫„ÄÇÂêåÊó∂Ôºå‰∏∫‰∫ÜÂÖ¨Âπ≥Ëµ∑ËßÅÔºåÂØπÊØîÂü∫ÂáÜ‰∏çÂ∫îËØ•‰ªÖ‰ªÖÊòØËÆ©DPPÂ§±ÊïàÁöÑÊµãËØïÁî®‰æãÔºåËÄåÂ∫îËØ•ÊòØapplyDistinctDFÂä†CacheÁöÑÊµãËØïÁî®‰æã„ÄÇ‰∏éÊ≠§ÂêåÊó∂ÔºåÊàë‰ª¨Áõ¥Êé•ÂØπÊØîDPPÁöÑÁ£ÅÁõòËØªÂèñÊïàÁéá‰∏éCacheÁöÑÂÜÖÂ≠òËØªÂèñÊïàÁéáÔºå‰πüËÉΩÂä†Ê∑±ÂØπDPPÊú∫Âà∂ÁöÑËÆ§Áü•‰∏éÁêÜËß£„ÄÇ</p>
<p>Êää‰∏äËø∞‰∏§‰∏™ÊµãËØïÁî®‰æã‰∫§‰ªòÊâßË°åÔºåËøêË°åÁªìÊûúÂ¶Ç‰∏ã„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåÁõ∏ËæÉÂØπÊØîÂü∫ÂáÜÔºåÂú®DPPÊú∫Âà∂ÁöÑ‰ΩúÁî®‰∏ãÔºåÊ°à‰æã4Á´ØÂà∞Á´ØÁöÑÊâßË°åÊÄßËÉΩÊúâÁùÄÂ∞ÜËøë5ÂÄçÁöÑÊèêÂçá„ÄÇÁî±Ê≠§ÂèØËßÅÔºåÊï∞ÊçÆÈõÜÂä†Cache‰πãÂêéÁöÑÂÜÖÂ≠òËØªÂèñÔºåËøú‰∏çÂ¶ÇDPPÊú∫Âà∂‰∏ãÁöÑÁ£ÅÁõòËØªÂèñÊõ¥È´òÊïà„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100509354-4509911.png"
	width="1600"
	height="446"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100509354-4509911_hu1701982457055427767.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100509354-4509911_hu12980775000504951598.png 1024w"
	loading="lazy"
	
		alt="image-20250413100509354"
	
	
		class="gallery-image" 
		data-flex-grow="358"
		data-flex-basis="860px"
	
></p>
<h2 id="Ê°à‰æã5ÁöÑÊÄßËÉΩË∞É‰ºòÂÄçÁéáÂàÜÊûê">Ê°à‰æã5ÁöÑÊÄßËÉΩË∞É‰ºòÔºöÂÄçÁéáÂàÜÊûê
</h2><p>Ê°à‰æã5‰πüÂåÖÂê´‰∏§‰∏™Âú∫ÊôØÔºåÂú∫ÊôØ1ÁöÑ‰∏öÂä°ÁõÆÊ†áÊòØËÆ°ÁÆó‰∏çÂêåÂÄçÁéá‰∏ãÁöÑ‰∏≠Á≠æ‰∫∫Êï∞ÔºåÂú∫ÊôØ2‰∏éÂú∫ÊôØ1Áõ∏ÊØîÁ®çÊúâ‰∏çÂêåÔºåÂÆÉÁöÑÁõÆÁöÑÊòØËÆ°ÁÆó‰∏çÂêåÂÄçÁéá‰∏ãÁöÑ‰∏≠Á≠æÊØî‰æã„ÄÇ</p>
<p>Â∞ΩÁÆ°‰∏§‰∏™Âú∫ÊôØÁöÑËÆ°ÁÆóÈÄªËæëÊúâÂå∫Âà´Ôºå‰ΩÜÊòØË∞É‰ºòÊÄùË∑Ø‰∏éÊñπÊ≥ïÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂú®Ê°à‰æã5‰∏≠ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂØπÂú∫ÊôØ1ÁöÑÊÄßËÉΩ‰ºòÂåñËøõË°åÊé¢ËÆ®„ÄÅÂàÜÊûê‰∏éÂØπÊØîÔºåÊàë‰ª¨ÂÖàÊù•ÂõûÈ°æ‰∏Ä‰∏ãÂú∫ÊôØ1ÁöÑ‰ª£Á†ÅÂÆûÁé∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">val</span><span class="w"> </span><span class="n">result05_01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applyNumbersDF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">luckyDogsDF</span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s">&#34;201601&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">Seq</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">),</span><span class="w"> </span><span class="s">&#34;inner&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;batchNum&#34;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;multiplier&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="s">&#34;carNum&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="s">&#34;multiplier&#34;</span><span class="p">).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;multiplier&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span><span class="s">&#34;multiplier&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">agg</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="n">1</span><span class="p">)).</span><span class="na">alias</span><span class="p">(</span><span class="s">&#34;cnt&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="s">&#34;multiplier&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result05_01</span><span class="p">.</span><span class="na">write</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;csv&#34;</span><span class="p">).</span><span class="na">save</span><span class="p">(</span><span class="s">&#34;_&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªîÁªÜÁ†îËØª‰ª£Á†Å‰πãÂêéÔºåÊàë‰ª¨ÂèëÁé∞Âú∫ÊôØ1ÁöÑËÆ°ÁÆóÂàÜ‰∏∫Â¶Ç‰∏ãÂá†‰∏™ÁéØËäÇÔºö</p>
<ul>
<li>Â§ßË°®‰∏éÂ∞èË°®ÁöÑÂÖ≥ËÅîËÆ°ÁÆóÔºå‰∏îÂ∞èË°®Â∏¶ËøáÊª§Êù°‰ª∂</li>
<li>ÊåâbatchNumÂàóÂÅöÁªüËÆ°ËÆ°Êï∞</li>
<li>ÊåâcarNumÂàóÂèñÊúÄÂ§ßÂÄº</li>
<li>ÊåâmultiplierÂàóÂÅöÁªüËÆ°ËÆ°Êï∞</li>
</ul>
<p>Âú®Ëøô4‰∏™ÁéØËäÇÂΩì‰∏≠ÔºåÂÖ≥ËÅîËÆ°ÁÆóÊ∂âÂèäÁöÑÊï∞ÊçÆÊâ´ÊèèÈáèÂíåÊï∞ÊçÆÂ§ÑÁêÜÈáèÊúÄÂ§ß„ÄÇÂõ†Ê≠§ÔºåËøô‰∏ÄÁéØËäÇÊòØÊ°à‰æã5ÊâßË°åÊïàÁéáÁöÑÂÖ≥ÈîÆÊâÄÂú®„ÄÇÂè¶Â§ñÔºåÈô§‰∫ÜÂÖ≥ËÅîËÆ°ÁÆóÁéØËäÇÔºåÂÖ∂‰ªñ3‰∏™ÁéØËäÇÈÉΩÂ±û‰∫éÂçïË°®Shuffle‰ºòÂåñÁöÑËåÉÁï¥ÔºåËøô3‰∏™ÁéØËäÇÁöÑ‰ºòÂåñÂèØ‰ª•ÂèÇËÄÉÊ°à‰æã2Âú∫ÊôØ1ÁöÑË∞É‰ºòÊÄùË∑Ø‰∏éÊäÄÂ∑ßÔºåÂí±‰ª¨‰πü‰∏çÂ§öËØ¥‰∫Ü„ÄÇÂõ†Ê≠§ÔºåÂØπ‰∫éÊ°à‰æã5ÁöÑÊÄßËÉΩ‰ºòÂåñÔºåÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®Á¨¨‰∏Ä‰∏™ÁéØËäÇÔºå‰πüÂ∞±ÊòØapplyNumbersDF‰∏éluckyDogsDFÁöÑÂÖ≥ËÅîËÆ°ÁÆó„ÄÇ</p>
<p>‰ªîÁªÜËßÇÂØüÁ¨¨‰∏Ä‰∏™ÁéØËäÇÁöÑÂÖ≥ËÅîËÆ°ÁÆóÔºåÊàë‰ª¨ÂèëÁé∞ÂÖ≥ËÅîÊù°‰ª∂‰∏≠ÁöÑJoin KeyÊòØcarNumÔºåËÄåcarNumÂπ∂‰∏çÊòØapplyNumbersDF‰∏éluckyDogsDF‰∏§Âº†Ë°®ÁöÑÂàÜÂå∫ÈîÆÔºåÂõ†Ê≠§ÔºåÂú®Ëøô‰∏™ÂÖ≥ËÅîÊü•ËØ¢‰∏≠ÔºåÊàë‰ª¨Ê≤°ÊúâÂäûÊ≥ïÂà©Áî®DPPÊú∫Âà∂ÂéªÂÅö‰ºòÂåñ„ÄÇ</p>
<p>‰∏çËøáÔºåapplyNumbersDF‰∏éluckyDogsDFÁöÑÂÜÖÂÖ≥ËÅîÊòØÂÖ∏ÂûãÁöÑ‚ÄúÂ§ßË°®JoinÂ∞èË°®‚ÄùÔºåÂØπ‰∫éËøôÁßçÂú∫ÊôØÔºåÊàë‰ª¨Ëá≥Â∞ëÊúâ‰∏§ÁßçÊñπÊ≥ïÂèØ‰ª•Â∞Ü‰ΩéÊïàÁöÑSMJËΩ¨Âåñ‰∏∫È´òÊïàÁöÑBHJ„ÄÇ</p>
<p>Á¨¨‰∏ÄÁßçÂäûÊ≥ïÊòØËÆ°ÁÆóÂéüÂßãÊï∞ÊçÆÈõÜluckyDogsDFÁöÑÂÜÖÂ≠òÂ≠òÂÇ®Â§ßÂ∞èÔºåÁ°Æ‰øùÂÖ∂Â∞è‰∫éÂπøÊí≠ÈòàÂÄºÔºå‰ªéËÄåÂà©Áî®Spark SQLÁöÑÈùôÊÄÅ‰ºòÂåñÊú∫Âà∂Â∞ÜSMJËΩ¨Âåñ‰∏∫BHJ„ÄÇÁ¨¨‰∫åÁßçÊñπÊ≥ïÊòØÁ°Æ‰øùËøáÊª§ÂêéÁöÑluckyDogsDFÂ∞è‰∫éÂπøÊí≠ÈòàÂÄºÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®Spark SQLÁöÑAQEÊú∫Âà∂Êù•Âä®ÊÄÅÂú∞Â∞ÜSMJËΩ¨Âåñ‰∏∫BHJ„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂàÜÂà´‰ΩøÁî®Ëøô‰∏§ÁßçÊñπÊ≥ïÊù•ÂÅö‰ºòÂåñÔºåÊØîËæÉÂÆÉ‰ª¨‰πãÈó¥Ôºå‰ª•ÂèäÂÆÉ‰ª¨‰∏éÂØπÊØîÂü∫ÂáÜ‰πãÈó¥ÁöÑÊÄßËÉΩÂ∑ÆÂºÇ„ÄÇÂú®Ê°à‰æã2Âú∫ÊôØ2‰∏≠ÔºåÊàë‰ª¨ËÆ°ÁÆóËøáluckyDogsDFÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®Â§ßÂ∞èÊòØ18.5MBÔºåÂõ†Ê≠§ÔºåÈÄöËøáÈÄÇÂΩìË∞ÉËäÇspark.sql.autoBroadcastJoinThresholdÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÁÅµÊ¥ªÂú∞Âú®‰∏§ÁßçË∞É‰ºòÊñπÊ≥ï‰πãÈó¥ËøõË°åÂàáÊç¢„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100153635.png"
	width="1608"
	height="370"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100153635_hu6360441420781906689.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100153635_hu12605627327634959688.png 1024w"
	loading="lazy"
	
		alt="image-20250413100153635"
	
	
		class="gallery-image" 
		data-flex-grow="434"
		data-flex-basis="1043px"
	
></p>
<p>Â∞Ü3ÁßçÊµãËØïÁî®‰æã‰ªòËØ∏ÊâßË°åÔºåÂú®ÊâßË°åÊïàÁéáÊñπÈù¢ÔºåSMJÊØ´Êó†ÊÇ¨ÂøµÊòØÊúÄÂ∑ÆÁöÑÔºåËÄåAQEÁöÑÂä®ÊÄÅ‰ºòÂåñ‰ªã‰∫éSMJ‰∏éSpark SQLÁöÑÈùôÊÄÅËΩ¨Âåñ‰πãÈó¥„ÄÇÊØïÁ´üÔºåAQEÁöÑJoinÁ≠ñÁï•Ë∞ÉÊï¥ÊòØ‰∏ÄÁßç‚Äú‰∫°ÁæäË°•Áâ¢„ÄÅÁäπÊú™‰∏∫Êôö‚ÄùÁöÑ‰ºòÂåñÊú∫Âà∂ÔºåÂú®ÊääSMJË∞ÉÊï¥‰∏∫BHJ‰πãÂâçÔºåÂèÇ‰∏éJoinÁöÑ‰∏§Âº†Ë°®ÁöÑShuffleËÆ°ÁÆóÂ∑≤ÁªèÊâßË°åËøáÂçä„ÄÇÂõ†Ê≠§ÔºåÂÆÉÁöÑÊâßË°åÊïàÁéá‰∏ÄÂÆöÊØîSpark SQLÁöÑÈùôÊÄÅ‰ºòÂåñÊõ¥Â∑Æ„ÄÇÂ∞ΩÁÆ°Â¶ÇÊ≠§ÔºåAQEÂä®ÊÄÅË∞ÉÊï¥ËøáÂêéÁöÑBHJËøòÊòØÊØîÈªòËÆ§ÁöÑSMJË¶ÅÈ´òÊïàÂæóÂ§öÔºåËÄåËøô‰πü‰ΩìÁé∞‰∫ÜAQE‰ºòÂåñÊú∫Âà∂ÁöÑ‰ª∑ÂÄºÊâÄÂú®„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100214073-4509735.png"
	width="1596"
	height="456"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100214073-4509735_hu1029878328910484258.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100214073-4509735_hu9338572866641015106.png 1024w"
	loading="lazy"
	
		alt="image-20250413100214073"
	
	
		class="gallery-image" 
		data-flex-grow="350"
		data-flex-basis="840px"
	
></p>
<h2 id="ÊÄªÁªì">ÊÄªÁªì
</h2><p>‰ªäÂ§©Ëøô‰∏ÄËÆ≤ÔºåÊàë‰ª¨ÁªìÂêà‰ª•ÂâçÂ≠¶ËøáÁöÑÁü•ËØÜÁÇπ‰∏éË∞É‰ºòÊäÄÂ∑ßÔºå‰ª•Â∞èÊ±ΩËΩ¶ÊëáÂè∑‰∏∫‰æãCase By CaseÂú∞ÂÅöÊÄßËÉΩ‰ºòÂåñ„ÄÇÊ∂âÂèäÁöÑ‰ºòÂåñÊäÄÂ∑ßÊúâShuffleËØªÂÜôÁºìÂÜ≤Âå∫Ë∞ÉÊï¥„ÄÅÂä†Cache„ÄÅÈ¢Ñ‰º∞Êï∞ÊçÆÈõÜÂ≠òÂÇ®Â§ßÂ∞è„ÄÅSpark SQLÈùôÊÄÅ‰ºòÂåñ„ÄÅAQEÂä®ÊÄÅ‰ºòÂåñÔºàËá™Âä®ÂàÜÂå∫ÂêàÂπ∂‰∏éJoinÁ≠ñÁï•Ë∞ÉÊï¥Ôºâ‰ª•ÂèäDPPÊú∫Âà∂„ÄÇ‰∏∫‰∫ÜÊñπ‰æø‰Ω†ÂØπÊØîÔºåÊàëÊääÂÆÉ‰ª¨ÊÄªÁªìÂú®‰∫Ü‰∏ÄÂº†ËÑëÂõæÈáå„ÄÇ‰∏çËøáÔºåÊàëÊõ¥Â∏åÊúõ‰Ω†ËÉΩËá™Â∑±ÊÄªÁªì‰∏Ä‰∏ãÔºåËøôÊ†∑ÊâçËÉΩËÆ∞ÂæóÊõ¥Â•Ω„ÄÇ</p>
<p><img src="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770.png"
	width="1630"
	height="286"
	srcset="/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770_hu8754687488732352479.png 480w, /p/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%80%A7%E8%83%BD/image-20250413100248830-4509770_hu3164633295090456417.png 1024w"
	loading="lazy"
	
		alt="image-20250413100248830"
	
	
		class="gallery-image" 
		data-flex-grow="569"
		data-flex-basis="1367px"
	
></p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E8%B0%83%E5%BA%A6%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8%E8%AE%B2%E8%A7%A3/">
        
        
            <div class="article-image">
                <img src="/p/%E8%B0%83%E5%BA%A6%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8%E8%AE%B2%E8%A7%A3/lizard-8007238_1280.99221b6ddc6adbd3b3d4b2a2ff222b99_hu9270167774858500963.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Ë∞ÉÂ∫¶Á≥ªÁªüÂÖ•Èó®ËÆ≤Ëß£"
                        
                        data-hash="md5-mSIbbdxq29Oz1LKi/yIrmQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Ë∞ÉÂ∫¶Á≥ªÁªüÂÖ•Èó®ËÆ≤Ëß£</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8Bjob%E4%BC%98%E5%8C%96/">
        
        
            <div class="article-image">
                <img src="/p/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8Bjob%E4%BC%98%E5%8C%96/paddle-boat-8253274_1280.f75fabdedeae0941d378faac2224d26d_hu17172630445701689797.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ÊÄßËÉΩË∞É‰ºò‰πãJob‰ºòÂåñ"
                        
                        data-hash="md5-91&#43;r3t6uCUHTePqsIiTSbQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ÊÄßËÉΩË∞É‰ºò‰πãJob‰ºòÂåñ</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/">
        
        
            <div class="article-image">
                <img src="/p/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/gannet-9003524_1280.aa511a7310cfa3385af52b3a0fffbbde_hu3687632605550775934.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ÊÄßËÉΩË∞É‰ºò‰πãÊï∞ÊçÆÂÄæÊñú"
                        
                        data-hash="md5-qlEacxDPozha9Ss6D/&#43;73g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ÊÄßËÉΩË∞É‰ºò‰πãÊï∞ÊçÆÂÄæÊñú</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/blockmanager%E7%AE%A1%E7%90%86%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">
        
        
            <div class="article-image">
                <img src="/p/blockmanager%E7%AE%A1%E7%90%86%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/dolphin-8949505_1280.b851b2721acfbb3b660cb93a718d57d3_hu5252129146125328555.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post BlockManagerÁÆ°ÁêÜÊ∫êÁ†ÅËß£Êûê"
                        
                        data-hash="md5-uFGychrPuztmDLk6cY1X0w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">BlockManagerÁÆ°ÁêÜÊ∫êÁ†ÅËß£Êûê</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/spark%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0/">
        
        
            <div class="article-image">
                <img src="/p/spark%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0/grebe-7972183_1280.6dd8a2d7b8cf99148cf7a877d9459ae8_hu10399000877992530385.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post SparkÂπøÊí≠Êú∫Âà∂Ê∫êÁ†ÅÂÆûÁé∞"
                        
                        data-hash="md5-bdii17jPmRSM96h32UWa6A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SparkÂπøÊí≠Êú∫Âà∂Ê∫êÁ†ÅÂÆûÁé∞</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="sherlock-lin/utterances-comments"
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2025 sherlock-lin
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">Êú¨Á´ôÊÄªËÆøÈóÆÈáè <span id="busuanzi_value_site_pv"></span> Ê¨° ¬∑ </span>
<span id="busuanzi_container_site_uv">ÊÇ®ÊòØÊú¨Á´ôÁ¨¨ <span id="busuanzi_value_site_uv"></span> ‰ΩçËÆøÈóÆËÄÖ</span>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
